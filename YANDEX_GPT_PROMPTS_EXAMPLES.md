# üìù –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–º–ø—Ç–æ–≤ Yandex GPT - –ü–æ–ª–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è

**–î–∞—Ç–∞:** 24 –Ω–æ—è–±—Ä—è 2025
**–ü—Ä–æ–µ–∫—Ç:** AI Calendar Assistant

---

## üéØ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã](#—Å–∏—Å—Ç–µ–º–Ω—ã–µ-–ø—Ä–æ–º–ø—Ç—ã)
2. [–ü—Ä–∏–º–µ—Ä—ã –ø–æ —è–∑—ã–∫–∞–º](#–ø—Ä–∏–º–µ—Ä—ã-–ø–æ-—è–∑—ã–∫–∞–º)
3. [–ö–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–∫–µ–π—Å—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
4. [–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏](#–≥—Ä–∞–Ω–∏—á–Ω—ã–µ-—Å–ª—É—á–∞–∏)

---

## ü§ñ –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

### –ë–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–ø–æ–ª–Ω—ã–π)

```
You are an intelligent calendar assistant.
Your task is to understand user commands in natural language (Russian, English, Spanish, or Arabic)
and convert them into structured calendar actions.

Possible actions (intent):
- create: create a single new event WITH specific time
- create_recurring: create recurring events (daily, weekly, monthly patterns)
- update: modify an existing event
- delete: delete an event
- query: query information about events
- find_free_slots: find free time
- batch_confirm: confirm multiple specific events (for deletions or custom lists)
- delete_by_criteria: delete events matching criteria (title contains, date range)
- delete_duplicates: delete duplicate events (same title and time)
- todo: create a task WITHOUT specific time slot
- clarify: ask for clarification if information is insufficient

DISTINGUISHING EVENTS vs TASKS (TODO):
Use intent="todo" when:
- Action verbs WITHOUT specific time: –Ω–∞–ø–∏—Å–∞—Ç—å, –ø–æ–∑–≤–æ–Ω–∏—Ç—å, –∫—É–ø–∏—Ç—å, –∏–∑—É—á–∏—Ç—å, —Å–¥–µ–ª–∞—Ç—å
- User says "–∑–∞–≤—Ç—Ä–∞", "–≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" but NO specific time mentioned
- Request is about completing something, not scheduling something
- Keywords: "–Ω–∞–¥–æ", "–Ω—É–∂–Ω–æ", "–Ω–µ –∑–∞–±—ã—Ç—å", "—Å–¥–µ–ª–∞—Ç—å", "—Å–ø–∏—Å–æ–∫ –¥–µ–ª"
- Abbreviations: "–ø–Ω–¥" = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- CRITICAL: If no time specified ‚Üí ALWAYS use intent="todo", NEVER use intent="clarify"

Use intent="create" (calendar event) when:
- Specific time mentioned: "–≤ 15:00", "at 3pm", "–∑–∞–≤—Ç—Ä–∞ –≤ 10 —É—Ç—Ä–∞"
- Meeting/appointment words WITH time
- Events that occupy a specific time slot

Examples:
- "–ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç—á–µ—Ç –∑–∞–≤—Ç—Ä–∞" ‚Üí intent="todo" (no specific time)
- "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00" ‚Üí intent="create" (specific time)
- "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –ò–≤–∞–Ω—É" ‚Üí intent="todo" (no time)
- "–ó–≤–æ–Ω–æ–∫ —Å –ò–≤–∞–Ω–æ–º –∑–∞–≤—Ç—Ä–∞ –≤ 10:00" ‚Üí intent="create" (specific time)
- "–û–±–Ω–æ–≤–∏—Ç—å –ø–Ω–¥" ‚Üí intent="todo", title="–û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"

Rules:
1. Always return time in ISO 8601 format with user's timezone
2. For EVENTS: If information missing (date, time, title) - use intent=clarify
2a. For TODO: Only title required. If "–∑–∞–≤—Ç—Ä–∞" mentioned, set due_date
2b. For TODO: start_time and end_time should be NULL
3. IMPORTANT: For relative dates calculate exact date relative to CURRENT DATE
4. IMPORTANT: Use context from previous messages for clarification
5. Default duration is 60 minutes if not specified
6. Extract attendees from text

RECURRING EVENTS:
8. For "every day", "daily", use intent="create_recurring"
9. Include fields:
   - recurrence_type: "daily" | "weekly" | "monthly"
   - recurrence_end_date: when to stop
   - recurrence_days: (weekly) ["mon", "wed", "fri"]

10. CRITICAL RULES for duration (TODAY is {today_str}):
   - "every day" WITHOUT period ‚Üí recurrence_end_date = {end_of_year_date}
   - "for 3 days" ‚Üí recurrence_end_date = today + 3 days
   - "until Friday" ‚Üí recurrence_end_date = next Friday

11. Examples:
   - "–±–µ–≥ –ø–æ —É—Ç—Ä–∞–º –≤ 9 —á–∞—Å–æ–≤" ‚Üí create_recurring, daily, 9:00
   - "–∫–∞–∂–¥—ã–π –≤—Ç–æ—Ä–Ω–∏–∫ –≤ 14 —Å–æ–≤–µ—â–∞–Ω–∏–µ" ‚Üí create_recurring, weekly, ["tue"], 14:00

DELETION OPERATIONS:
16. For "delete all X" ‚Üí intent="delete_by_criteria"
17. For "delete X" (single) ‚Üí intent="delete" with event_id
18. NEVER return large batch_actions arrays

BATCH SCHEDULE CREATION:
21. If user provides MULTIPLE time ranges (3+ lines), create batch_actions
22. Schedule format patterns:
    - Multiple lines: HH:MM-HH:MM title
    - All for same date
23. Return intent="batch_confirm" with batch_actions array

MULTIPLE EVENTS IN ONE COMMAND:
26. When MULTIPLE events/tasks with connectors ("–ø–æ—Ç–æ–º", "then"), use batch_actions
27. Parse each part separately
28. Examples:
    - "–í 17 –≤—Å—Ç—Ä–µ—á–∞, –≤ 19 —É–∂–∏–Ω –∏ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ" ‚Üí
      [{create 17:00}, {create 19:00}, {todo}]

IMPORTANT: Return ONLY JSON with fields from set_calendar_action function.
```

---

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (—Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫)

```
–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –Ø–ó–´–ö –û–ë–©–ï–ù–ò–Ø –° –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú - –†–£–°–°–ö–ò–ô!
–í–°–ï —Ç–≤–æ–∏ –æ—Ç–≤–µ—Ç—ã (clarify_question, –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π, –æ–ø–∏—Å–∞–Ω–∏—è) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—â–∞–µ—Ç—Å—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

–í–ê–ñ–ù–û: –¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê –ò –í–†–ï–ú–Ø: 24.11.2025 15:30 (Europe/Moscow, UTC+03:00), –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
–ò—Å–ø–æ–ª—å–∑—É–π —ç—Ç—É –¥–∞—Ç—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞—Ç (–∑–∞–≤—Ç—Ä–∞, –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞, —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é –∏ —Ç.–¥.)

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞—Ç –æ—Ç –¢–ï–ö–£–©–ï–ô –î–ê–¢–´ (24.11.2025):
- "–∑–∞–≤—Ç—Ä–∞" = 25.11.2025 (2025-11-25)
- "–ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞" = 26.11.2025 (2025-11-26)
- "—á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é" = 01.12.2025 (2025-12-01)

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ë–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ –æ—Ç –¢–ï–ö–£–©–ï–ô –î–ê–¢–´ (24.11.2025, –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ):
- "–≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" –∏–ª–∏ "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" = 25.11.2025 (2025-11-25)
- "–≤–æ –≤—Ç–æ—Ä–Ω–∏–∫" –∏–ª–∏ "–≤—Ç–æ—Ä–Ω–∏–∫" = 26.11.2025 (2025-11-26)
- "–≤ —Å—Ä–µ–¥—É" –∏–ª–∏ "—Å—Ä–µ–¥–∞" = 27.11.2025 (2025-11-27)
- "–≤ —á–µ—Ç–≤–µ—Ä–≥" –∏–ª–∏ "—á–µ—Ç–≤–µ—Ä–≥" = 28.11.2025 (2025-11-28)
- "–≤ –ø—è—Ç–Ω–∏—Ü—É" –∏–ª–∏ "–ø—è—Ç–Ω–∏—Ü–∞" = 29.11.2025 (2025-11-29)
- "–≤ —Å—É–±–±–æ—Ç—É" –∏–ª–∏ "—Å—É–±–±–æ—Ç–∞" = 30.11.2025 (2025-11-30)
- "–≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ" –∏–ª–∏ "–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ" = 01.12.2025 (2025-12-01)

–í–ù–ò–ú–ê–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–û —ç—Ç–∏ –¥–∞—Ç—ã –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤! –ù–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–π –∏—Ö —Å–∞–º!
```

---

### Existing Events Context (–¥–ª—è UPDATE/DELETE)

```
<existing_calendar_events>
Event: –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π
Time: 24.11.2025 15:00
ID: abc-123-def-456

Event: –ü–æ–∫–∞–∑ –∫–≤–∞—Ä—Ç–∏—Ä—ã –Ω–∞ –õ–µ–Ω–∏–Ω–∞ 25
Time: 25.11.2025 10:00
ID: xyz-789-ghi-012

Event: –ó–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º
Time: 26.11.2025 14:00
ID: uvw-345-jkl-678

</existing_calendar_events>

CRITICAL: For update/delete operations:
- Find the event in the list above by matching title/description
- COPY the exact ID value - NEVER use "unknown"
- Example: "–ø–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π" ‚Üí find "–í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π" ‚Üí copy its ID: abc-123-def-456

User request:
```

---

## üåç –ü—Ä–∏–º–µ—Ä—ã –ø–æ —è–∑—ã–∫–∞–º

### –†—É—Å—Å–∫–∏–π —è–∑—ã–∫

#### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```
USER: –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∑–∞–≤—Ç—Ä–∞ –≤ 15:00

SYSTEM PROMPT:
[–±–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç]
–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
"–∑–∞–≤—Ç—Ä–∞" = 25.11.2025
User request: –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∑–∞–≤—Ç—Ä–∞ –≤ 15:00

YANDEX GPT RESPONSE:
{
  "intent": "create",
  "title": "–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º",
  "start_time": "2025-11-25T15:00:00+03:00",
  "end_time": "2025-11-25T16:00:00+03:00",
  "duration_minutes": 60,
  "confidence": 0.95
}
```

#### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–¥–∞—á–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
```
USER: –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

SYSTEM PROMPT:
Use intent="todo" when no time specified
User request: –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

YANDEX GPT RESPONSE:
{
  "intent": "todo",
  "title": "–û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
  "confidence": 0.9
}
```

#### –ü—Ä–∏–º–µ—Ä 3: –ó–∞–ø—Ä–æ—Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```
USER: –ß—Ç–æ —É –º–µ–Ω—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?

SYSTEM PROMPT:
For "–Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ": query_date_start=today, query_date_end=today+7 days
–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
User request: –ß—Ç–æ —É –º–µ–Ω—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?

YANDEX GPT RESPONSE:
{
  "intent": "query",
  "query_date_start": "2025-11-24T00:00:00+03:00",
  "query_date_end": "2025-12-01T23:59:59+03:00",
  "confidence": 0.95
}
```

---

### English

#### Example 1: Create event
```
USER: Meeting with John tomorrow at 3pm

SYSTEM PROMPT:
CRITICAL: USER LANGUAGE IS ENGLISH!
CURRENT DATE: 24.11.2025
"tomorrow" = 25.11.2025 (2025-11-25)
User request: Meeting with John tomorrow at 3pm

YANDEX GPT RESPONSE:
{
  "intent": "create",
  "title": "Meeting with John",
  "start_time": "2025-11-25T15:00:00+03:00",
  "end_time": "2025-11-25T16:00:00+03:00",
  "duration_minutes": 60,
  "confidence": 0.95
}
```

#### Example 2: TODO task
```
USER: Call the client

SYSTEM PROMPT:
Use intent="todo" when no time specified
User request: Call the client

YANDEX GPT RESPONSE:
{
  "intent": "todo",
  "title": "Call the client",
  "confidence": 0.9
}
```

---

## üìã –ö–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–µ–π—Å 1: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è —Å "–ø–æ—Ç–æ–º"

```
USER: –í 17 –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –ø–æ—Ç–æ–º –≤ 19 —É–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –∏ –µ—â–µ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ

SYSTEM PROMPT:
MULTIPLE EVENTS IN ONE COMMAND:
When user mentions MULTIPLE events/tasks with connectors ("–ø–æ—Ç–æ–º"), create batch_actions
Example: "–í 17 –≤—Å—Ç—Ä–µ—á–∞, –≤ 19 —É–∂–∏–Ω –∏ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ" ‚Üí
  [{create 17:00}, {create 19:00}, {todo}]

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025 15:30
User request: –í 17 –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –ø–æ—Ç–æ–º –≤ 19 —É–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ –∏ –µ—â–µ –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ

YANDEX GPT RESPONSE:
{
  "intent": "batch_confirm",
  "batch_actions": [
    {
      "intent": "create",
      "title": "–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º",
      "start_time": "2025-11-24T17:00:00+03:00",
      "end_time": "2025-11-24T18:00:00+03:00",
      "duration_minutes": 60
    },
    {
      "intent": "create",
      "title": "–£–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ",
      "start_time": "2025-11-24T19:00:00+03:00",
      "end_time": "2025-11-24T20:00:00+03:00",
      "duration_minutes": 60,
      "location": "—Ä–µ—Å—Ç–æ—Ä–∞–Ω"
    },
    {
      "intent": "todo",
      "title": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ"
    }
  ],
  "batch_summary": "üìÖ –°–æ–∑–¥–∞—Ç—å 2 —Å–æ–±—ã—Ç–∏—è –∏ 1 –∑–∞–¥–∞—á—É:\n‚Ä¢ 17:00 - –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º\n‚Ä¢ 19:00 - –£–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ\n‚Ä¢ –ó–∞–¥–∞—á–∞: –ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ",
  "confidence": 0.9
}

BOT RESPONSE:
üìÖ –°–æ–∑–¥–∞—Ç—å 2 —Å–æ–±—ã—Ç–∏—è –∏ 1 –∑–∞–¥–∞—á—É:
‚Ä¢ 17:00 - –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
‚Ä¢ 19:00 - –£–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ
‚Ä¢ –ó–∞–¥–∞—á–∞: –ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ?
[–°–æ–∑–¥–∞—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

---

### –ö–µ–π—Å 2: Schedule format (—Ç–∞–π–º–∏–Ω–≥)

```
USER:
—Ç–∞–π–º–∏–Ω–≥ –Ω–∞ 25 –Ω–æ—è–±—Ä—è:
12:45-13:00 –ü—Ä–∏–µ–∑–¥, –∑–∞—Å–µ–ª–µ–Ω–∏–µ
13:00-13:30 –ö–æ—Ñ–µ-–±—Ä–µ–π–∫ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ
13:30-15:00 –î–∏—Å–∫—É—Å—Å–∏—è –ø–æ –ò–ò
15:00-15:15 –ü–µ—Ä–µ—Ä—ã–≤
15:15-17:00 –í–æ—Ä–∫—à–æ–ø

PREPROCESSING (–±–µ–∑ LLM):
–°–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç schedule format —á–µ—Ä–µ–∑ _detect_schedule_format():
- 5 —Å—Ç—Ä–æ–∫ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º HH:MM-HH:MM
- –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ "—Ç–∞–π–º–∏–Ω–≥"
- –î–∞—Ç–∞: 25 –Ω–æ—è–±—Ä—è

RESULT (–±–µ–∑ –≤—ã–∑–æ–≤–∞ Yandex GPT):
{
  "intent": "batch_confirm",
  "batch_actions": [
    {
      "intent": "create",
      "title": "–ü—Ä–∏–µ–∑–¥, –∑–∞—Å–µ–ª–µ–Ω–∏–µ",
      "start_time": "2025-11-25T12:45:00+03:00",
      "end_time": "2025-11-25T13:00:00+03:00",
      "duration_minutes": 15
    },
    {
      "intent": "create",
      "title": "–ö–æ—Ñ–µ-–±—Ä–µ–π–∫ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ",
      "start_time": "2025-11-25T13:00:00+03:00",
      "end_time": "2025-11-25T13:30:00+03:00",
      "duration_minutes": 30
    },
    {
      "intent": "create",
      "title": "–î–∏—Å–∫—É—Å—Å–∏—è –ø–æ –ò–ò",
      "start_time": "2025-11-25T13:30:00+03:00",
      "end_time": "2025-11-25T15:00:00+03:00",
      "duration_minutes": 90
    },
    {
      "intent": "create",
      "title": "–ü–µ—Ä–µ—Ä—ã–≤",
      "start_time": "2025-11-25T15:00:00+03:00",
      "end_time": "2025-11-25T15:15:00+03:00",
      "duration_minutes": 15
    },
    {
      "intent": "create",
      "title": "–í–æ—Ä–∫—à–æ–ø",
      "start_time": "2025-11-25T15:15:00+03:00",
      "end_time": "2025-11-25T17:00:00+03:00",
      "duration_minutes": 105
    }
  ],
  "batch_summary": "üìÖ –°–æ–∑–¥–∞—Ç—å 5 —Å–æ–±—ã—Ç–∏–π\nüìç 25 –Ω–æ—è–±—Ä—è\nüîÑ –° 12:45 –¥–æ 17:00",
  "confidence": 0.9
}

BOT RESPONSE:
üìÖ –°–æ–∑–¥–∞—Ç—å 5 —Å–æ–±—ã—Ç–∏–π
üìç 25 –Ω–æ—è–±—Ä—è, –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
üîÑ –° 12:45 –¥–æ 17:00

–°–æ–±—ã—Ç–∏—è:
‚Ä¢ 12:45-13:00 –ü—Ä–∏–µ–∑–¥, –∑–∞—Å–µ–ª–µ–Ω–∏–µ
‚Ä¢ 13:00-13:30 –ö–æ—Ñ–µ-–±—Ä–µ–π–∫ –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ
‚Ä¢ 13:30-15:00 –î–∏—Å–∫—É—Å—Å–∏—è –ø–æ –ò–ò
‚Ä¢ 15:00-15:15 –ü–µ—Ä–µ—Ä—ã–≤
‚Ä¢ 15:15-17:00 –í–æ—Ä–∫—à–æ–ø

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ?
[–°–æ–∑–¥–∞—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

---

### –ö–µ–π—Å 3: –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è

```
USER: –ë–µ–≥ –ø–æ —É—Ç—Ä–∞–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9 —á–∞—Å–æ–≤

SYSTEM PROMPT:
RECURRING EVENTS:
For "–±–µ–≥ –ø–æ —É—Ç—Ä–∞–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9 —á–∞—Å–æ–≤" ‚Üí
  create_recurring, recurrence_type="daily", start_time=9:00
"every day" WITHOUT period ‚Üí recurrence_end_date = 2025-12-31

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
end_of_year = 2025-12-31
User request: –ë–µ–≥ –ø–æ —É—Ç—Ä–∞–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9 —á–∞—Å–æ–≤

YANDEX GPT RESPONSE:
{
  "intent": "create_recurring",
  "title": "–ë–µ–≥",
  "start_time": "09:00",
  "recurrence_type": "daily",
  "recurrence_end_date": "2025-12-31",
  "duration_minutes": 60,
  "confidence": 0.85
}

PROCESSING:
–°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 38 —Å–æ–±—ã—Ç–∏–π (25 –Ω–æ—è–±—Ä—è - 31 –¥–µ–∫–∞–±—Ä—è)

BOT RESPONSE:
üìÖ –°–æ–∑–¥–∞—Ç—å 38 —Å–æ–±—ã—Ç–∏–π: '–ë–µ–≥'
üìç –° 25 –Ω–æ—è–±—Ä—è –ø–æ 31 –¥–µ–∫–∞–±—Ä—è
‚è∞ –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 09:00

–°–æ–±—ã—Ç–∏—è –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ –≤—Å–µ –¥–Ω–∏ —Å 25.11 –ø–æ 31.12

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ?
[–°–æ–∑–¥–∞—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

---

### –ö–µ–π—Å 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (—Å existing_events)

```
USER: –ü–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π –Ω–∞ 16:00

SYSTEM PROMPT:
<existing_calendar_events>
Event: –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π
Time: 24.11.2025 15:00
ID: abc-123-def-456

Event: –ü–æ–∫–∞–∑ –∫–≤–∞—Ä—Ç–∏—Ä—ã
Time: 25.11.2025 10:00
ID: xyz-789-ghi-012
</existing_calendar_events>

CRITICAL: Find event by title/description, copy exact ID
Example: "–ø–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π" ‚Üí find "–í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π" ‚Üí ID: abc-123-def-456

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025 15:30
User request: –ü–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π –Ω–∞ 16:00

YANDEX GPT RESPONSE:
{
  "intent": "update",
  "event_id": "abc-123-def-456",
  "start_time": "2025-11-24T16:00:00+03:00",
  "end_time": "2025-11-24T17:00:00+03:00",
  "confidence": 0.9
}

PROCESSING:
1. –ù–∞—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ –ø–æ event_id
2. –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Ä–µ–º—è: 15:00 ‚Üí 16:00
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å

BOT RESPONSE:
‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
–í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π
–ë—ã–ª–æ: 15:00
–°—Ç–∞–ª–æ: 16:00
```

---

### –ö–µ–π—Å 5: –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º

```
USER: –£–¥–∞–ª–∏ –≤—Å–µ —É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∏—Ç—É–∞–ª—ã

SYSTEM PROMPT:
DELETION OPERATIONS:
For "—É–¥–∞–ª–∏ –≤—Å–µ X" ‚Üí intent="delete_by_criteria" with delete_criteria_title_contains
Example: "—É–¥–∞–ª–∏ –≤—Å–µ —É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∏—Ç—É–∞–ª—ã" ‚Üí delete_criteria_title_contains: "—É—Ç—Ä–µ–Ω–Ω"

User request: –£–¥–∞–ª–∏ –≤—Å–µ —É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–∏—Ç—É–∞–ª—ã

YANDEX GPT RESPONSE:
{
  "intent": "delete_by_criteria",
  "delete_criteria_title_contains": "—É—Ç—Ä–µ–Ω–Ω",
  "confidence": 0.85
}

PROCESSING:
1. –ò—â–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å "—É—Ç—Ä–µ–Ω–Ω" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
2. –ù–∞—Ö–æ–¥–∏—Ç 5 —Å–æ–±—ã—Ç–∏–π:
   - –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª (25.11)
   - –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª (26.11)
   - –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª (27.11)
   - –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–±–µ–∂–∫–∞ (28.11)
   - –£—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ—Ñ–µ (29.11)
3. –ü—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

BOT RESPONSE:
üóë –ù–∞–π–¥–µ–Ω–æ 5 —Å–æ–±—ã—Ç–∏–π —Å "—É—Ç—Ä–µ–Ω–Ω":

25 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00 –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª

26 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00 –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª

27 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00 –£—Ç—Ä–µ–Ω–Ω–∏–π —Ä–∏—Ç—É–∞–ª

28 –Ω–æ—è–±—Ä—è:
‚Ä¢ 08:00 –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–±–µ–∂–∫–∞

29 –Ω–æ—è–±—Ä—è:
‚Ä¢ 10:00 –£—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ—Ñ–µ

–£–¥–∞–ª–∏—Ç—å –≤—Å–µ 5 —Å–æ–±—ã—Ç–∏–π?
[–£–¥–∞–ª–∏—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

---

### –ö–µ–π—Å 6: Clarify (—É—Ç–æ—á–Ω–µ–Ω–∏–µ)

```
USER: –ü–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É

SYSTEM PROMPT:
<existing_calendar_events>
Event: –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π
Time: 24.11.2025 15:00
ID: abc-123

Event: –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
Time: 25.11.2025 10:00
ID: xyz-456

Event: –í—Å—Ç—Ä–µ—á–∞ –∫–æ–º–∞–Ω–¥—ã
Time: 26.11.2025 14:00
ID: uvw-789
</existing_calendar_events>

User request: –ü–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É

YANDEX GPT RESPONSE:
{
  "intent": "clarify",
  "clarify_question": "–ö–∞–∫—É—é –∏–º–µ–Ω–Ω–æ –≤—Å—Ç—Ä–µ—á—É –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏? –£ –≤–∞—Å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã:\n‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π (24.11 15:00)\n‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º (25.11 10:00)\n‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ –∫–æ–º–∞–Ω–¥—ã (26.11 14:00)",
  "confidence": 0.5
}

BOT RESPONSE:
–ö–∞–∫—É—é –∏–º–µ–Ω–Ω–æ –≤—Å—Ç—Ä–µ—á—É –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏? –£ –≤–∞—Å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã:
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π (24.11 15:00)
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º (25.11 10:00)
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ –∫–æ–º–∞–Ω–¥—ã (26.11 14:00)

---> USER FOLLOW-UP:
–° –õ–µ–Ω–æ–π

SYSTEM PROMPT (2nd turn):
<existing_calendar_events>
[—Ç–µ –∂–µ —Å–æ–±—ã—Ç–∏—è]
</existing_calendar_events>

Conversation history:
User: "–ü–µ—Ä–µ–Ω–µ—Å–∏ –≤—Å—Ç—Ä–µ—á—É"
Assistant: "–ö–∞–∫—É—é –∏–º–µ–Ω–Ω–æ –≤—Å—Ç—Ä–µ—á—É –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏..."

Current user message: "–° –õ–µ–Ω–æ–π"

YANDEX GPT RESPONSE:
{
  "intent": "clarify",
  "clarify_question": "–ù–∞ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π?",
  "confidence": 0.6
}

BOT RESPONSE:
–ù–∞ –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å—Ç—Ä–µ—á—É —Å –õ–µ–Ω–æ–π?

---> USER FOLLOW-UP:
–ù–∞ 16:00

YANDEX GPT RESPONSE:
{
  "intent": "update",
  "event_id": "abc-123",
  "start_time": "2025-11-24T16:00:00+03:00",
  "confidence": 0.9
}

BOT RESPONSE:
‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
–í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π: 15:00 ‚Üí 16:00
```

---

## ‚ö†Ô∏è –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### –°–ª—É—á–∞–π 1: –°–æ–∫—Ä–∞—â–µ–Ω–∏—è (–ø–Ω–¥ = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

```
USER: –û–±–Ω–æ–≤–∏—Ç—å –ø–Ω–¥

SYSTEM PROMPT:
Abbreviations: "–ø–Ω–¥" = –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (personal data)
User request: –û–±–Ω–æ–≤–∏—Ç—å –ø–Ω–¥

YANDEX GPT RESPONSE:
{
  "intent": "todo",
  "title": "–û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
  "confidence": 0.85
}

BOT RESPONSE:
‚úÖ –ó–∞–ø–∏—Å–∞–ª –∑–∞–¥–∞—á—É
üìù –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

---

### –°–ª—É—á–∞–π 2: –î–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–∞—è –¥–∞—Ç–∞ (–ø—Ä–æ—à–ª—ã–π –≥–æ–¥ vs —Å–ª–µ–¥—É—é—â–∏–π)

```
USER:
—Ç–∞–π–º–∏–Ω–≥ –Ω–∞ 23 –æ–∫—Ç—è–±—Ä—è:
12:45-13:00 –ü—Ä–∏–µ–∑–¥
13:00-13:30 –ö–æ—Ñ–µ

PREPROCESSING:
_detect_schedule_format() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞—Ç—É:
- 23 –æ–∫—Ç—è–±—Ä—è 2025 —É–∂–µ –ø—Ä–æ—à–ª–æ (—Å–µ–≥–æ–¥–Ω—è 24 –Ω–æ—è–±—Ä—è)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç None ‚Üí LLM –¥–æ–ª–∂–µ–Ω —É—Ç–æ—á–Ω–∏—Ç—å –≥–æ–¥

SYSTEM PROMPT:
DATE AMBIGUITY for schedule format:
If date like "23 –æ–∫—Ç—è–±—Ä—è" is in the PAST, ASK for clarification
Example: "–£—Ç–æ—á–Ω–∏—Ç–µ: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ 23 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞ –∏–ª–∏ 2026 –≥–æ–¥–∞?"

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
User request: —Ç–∞–π–º–∏–Ω–≥ –Ω–∞ 23 –æ–∫—Ç—è–±—Ä—è...

YANDEX GPT RESPONSE:
{
  "intent": "clarify",
  "clarify_question": "–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ 23 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞ –∏–ª–∏ 2026 –≥–æ–¥–∞?",
  "confidence": 0.5
}

BOT RESPONSE:
–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞: —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ 23 –æ–∫—Ç—è–±—Ä—è 2025 –≥–æ–¥–∞ –∏–ª–∏ 2026 –≥–æ–¥–∞?

---> USER FOLLOW-UP:
2026

PREPROCESSING (2nd turn):
–°–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç year_override=2026 –∏–∑ conversation_history
–ü–∞—Ä—Å–∏—Ç schedule —Å 23.10.2026

RESULT:
[5 —Å–æ–±—ã—Ç–∏–π –Ω–∞ 23.10.2026]
```

---

### –°–ª—É—á–∞–π 3: –°–º–µ—à–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –∏ –∑–∞–¥–∞—á–∏

```
USER: –ó–∞–≤—Ç—Ä–∞ –≤ 10 –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –∏ –≤ 15 –∑–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º

SYSTEM PROMPT:
Mixed events and tasks detection:
- Events (with time) ‚Üí intent="create"
- Tasks (no time) ‚Üí intent="todo"
- Return batch_actions array

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
"–∑–∞–≤—Ç—Ä–∞" = 25.11.2025
User request: –ó–∞–≤—Ç—Ä–∞ –≤ 10 –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä –∏ –≤ 15 –∑–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º

YANDEX GPT RESPONSE:
{
  "intent": "batch_confirm",
  "batch_actions": [
    {
      "intent": "create",
      "title": "–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º",
      "start_time": "2025-11-25T10:00:00+03:00",
      "end_time": "2025-11-25T11:00:00+03:00"
    },
    {
      "intent": "todo",
      "title": "–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä",
      "due_date": "2025-11-25"
    },
    {
      "intent": "create",
      "title": "–ó–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º",
      "start_time": "2025-11-25T15:00:00+03:00",
      "end_time": "2025-11-25T16:00:00+03:00"
    }
  ],
  "batch_summary": "üìÖ –°–æ–∑–¥–∞—Ç—å 2 —Å–æ–±—ã—Ç–∏—è –∏ 1 –∑–∞–¥–∞—á—É –Ω–∞ 25 –Ω–æ—è–±—Ä—è",
  "confidence": 0.9
}

BOT RESPONSE:
üìÖ –°–æ–∑–¥–∞—Ç—å 2 —Å–æ–±—ã—Ç–∏—è –∏ 1 –∑–∞–¥–∞—á—É –Ω–∞ 25 –Ω–æ—è–±—Ä—è:

–°–æ–±—ã—Ç–∏—è:
‚Ä¢ 10:00-11:00 –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
‚Ä¢ 15:00-16:00 –ó–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º

–ó–∞–¥–∞—á–∏:
‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ?
[–°–æ–∑–¥–∞—Ç—å] [–û—Ç–º–µ–Ω–∞]
```

---

### –°–ª—É—á–∞–π 4: –ó–∞–ø—Ä–æ—Å "–Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ" (–≤–∞–∂–Ω—ã–π –≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π)

```
USER: –ß—Ç–æ —É –º–µ–Ω—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?

SYSTEM PROMPT:
CRITICAL: For "this week" or "—ç—Ç—É –Ω–µ–¥–µ–ª—é" queries:
  query_date_start = today
  query_date_end = today + 7 days
This includes ALL events from today through next 7 days

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025 (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
User request: –ß—Ç–æ —É –º–µ–Ω—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?

YANDEX GPT RESPONSE:
{
  "intent": "query",
  "query_date_start": "2025-11-24T00:00:00+03:00",
  "query_date_end": "2025-12-01T23:59:59+03:00",
  "confidence": 0.95
}

PROCESSING:
–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —Å 24.11 –ø–æ 01.12 (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ)

BOT RESPONSE:
üìÖ –í–∞—à–∏ –ø–ª–∞–Ω—ã –Ω–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é:

–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 24 –Ω–æ—è–±—Ä—è:
‚Ä¢ 17:00-18:00 –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
‚Ä¢ 19:00-20:00 –£–∂–∏–Ω –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ

–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 25 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00-10:00 –ë–µ–≥
‚Ä¢ 15:00-16:00 –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π

–í—Ç–æ—Ä–Ω–∏–∫, 26 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00-10:00 –ë–µ–≥
‚Ä¢ 14:00-15:00 –ó–≤–æ–Ω–æ–∫ —Å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º

–°—Ä–µ–¥–∞, 27 –Ω–æ—è–±—Ä—è:
‚Ä¢ 09:00-10:00 –ë–µ–≥
‚Ä¢ –ù–µ—Ç –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π

...
```

---

### –°–ª—É—á–∞–π 5: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

```
USER: –£–¥–∞–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã

SYSTEM PROMPT:
delete_duplicates: delete duplicate events (same title and time)
Use when user says "—É–¥–∞–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã", "—É–¥–∞–ª–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è", "—É–¥–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è"

User request: –£–¥–∞–ª–∏ –¥—É–±–ª–∏–∫–∞—Ç—ã

YANDEX GPT RESPONSE:
{
  "intent": "delete_duplicates",
  "confidence": 0.9
}

PROCESSING:
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ (title, start_time, end_time)
3. –ù–∞—Ö–æ–¥–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã:
   - "–ë–µ–≥" 25.11 09:00 (3 –∫–æ–ø–∏–∏)
   - "–í—Å—Ç—Ä–µ—á–∞" 26.11 10:00 (2 –∫–æ–ø–∏–∏)
4. –û—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ 1 –∫–æ–ø–∏–∏ –∫–∞–∂–¥–æ–≥–æ, —É–¥–∞–ª—è–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ

BOT RESPONSE:
üîç –ù–∞–π–¥–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: 3

–ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã:
‚Ä¢ –ë–µ–≥ (25.11 09:00) - 2 –¥—É–±–ª–∏–∫–∞—Ç–∞
‚Ä¢ –í—Å—Ç—Ä–µ—á–∞ (26.11 10:00) - 1 –¥—É–±–ª–∏–∫–∞—Ç

–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã?
[–£–¥–∞–ª–∏—Ç—å] [–û—Ç–º–µ–Ω–∞]

---> –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
‚úÖ –£–¥–∞–ª–µ–Ω–æ 3 –¥—É–±–ª–∏–∫–∞—Ç–∞
–û—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Ä–∏–≥–∏–Ω–∞–ª—ã
```

---

### –°–ª—É—á–∞–π 6: –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

```
USER: –ö–æ–≥–¥–∞ —è —Å–≤–æ–±–æ–¥–µ–Ω –∑–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ 16?

SYSTEM PROMPT:
find_free_slots: find free time
Example: "–ö–æ–≥–¥–∞ —è —Å–≤–æ–±–æ–¥–µ–Ω –∑–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ 16?" ‚Üí
  find_free_slots, query_date_start=tomorrow, query_time_start=16:00

–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025
"–∑–∞–≤—Ç—Ä–∞" = 25.11.2025
User request: –ö–æ–≥–¥–∞ —è —Å–≤–æ–±–æ–¥–µ–Ω –∑–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ 16?

YANDEX GPT RESPONSE:
{
  "intent": "find_free_slots",
  "query_date_start": "2025-11-25T00:00:00+03:00",
  "query_time_start": "2025-11-25T16:00:00+03:00",
  "confidence": 0.9
}

PROCESSING:
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ 25.11
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ—Å–ª–µ 16:00:
   - 17:00-18:00 –í—Å—Ç—Ä–µ—á–∞
   - 19:00-20:00 –£–∂–∏–Ω
3. –ù–∞—Ö–æ–¥–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã:
   - 16:00-17:00 (1 —á–∞—Å)
   - 18:00-19:00 (1 —á–∞—Å)
   - 20:00-23:00 (3 —á–∞—Å–∞)

BOT RESPONSE:
üïê –°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ 16:00:

‚Ä¢ 16:00-17:00 (1 —á–∞—Å)
‚Ä¢ 18:00-19:00 (1 —á–∞—Å)
‚Ä¢ 20:00-23:00 (3 —á–∞—Å–∞)

–í—Å–µ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ: 5 —á–∞—Å–æ–≤
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–º–ø—Ç–æ–≤

### –†–∞–∑–º–µ—Ä –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
- –ë–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç: ~3500 —Ç–æ–∫–µ–Ω–æ–≤
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–¥–∞—Ç—ã): ~1000 —Ç–æ–∫–µ–Ω–æ–≤
- Existing events (–µ—Å–ª–∏ –µ—Å—Ç—å): ~200-500 —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ 10 —Å–æ–±—ã—Ç–∏–π
- Conversation history: ~100-300 —Ç–æ–∫–µ–Ω–æ–≤

**–ò—Ç–æ–≥–æ –Ω–∞ –∑–∞–ø—Ä–æ—Å:** ~4500-5500 —Ç–æ–∫–µ–Ω–æ–≤

### –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ Yandex GPT
- –ü—Ä–æ—Å—Ç–æ–π intent (create/todo): ~100-200 —Ç–æ–∫–µ–Ω–æ–≤
- Batch operations: ~500-1500 —Ç–æ–∫–µ–Ω–æ–≤
- Clarify: ~50-150 —Ç–æ–∫–µ–Ω–æ–≤

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- Schedule format –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –î–û LLM ‚Üí —ç–∫–æ–Ω–æ–º–∏—è ~2000 —Ç–æ–∫–µ–Ω–æ–≤
- Conversation history –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è clarify ‚Üí —ç–∫–æ–Ω–æ–º–∏—è ~300 —Ç–æ–∫–µ–Ω–æ–≤
- Temperature=0.2 ‚Üí –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã

---

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–æ–º–ø—Ç–∏–Ω–≥–∞

### DO ‚úÖ
- –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –¢–ï–ö–£–©–£–Æ –î–ê–¢–£ –≤ –ø—Ä–æ–º–ø—Ç–µ
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞—Ç (–∑–∞–≤—Ç—Ä–∞, –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞)
- –ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ existing_events –¥–ª—è UPDATE/DELETE
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON schema –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- –£–∫–∞–∑—ã–≤–∞–π—Ç–µ —è–∑—ã–∫ –æ–±—â–µ–Ω–∏—è —è–≤–Ω–æ
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ maxTokens –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏

### DON'T ‚ùå
- –ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–æ–æ–±—â–µ–Ω–∏—è)
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã—Å–æ–∫—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É (>0.3)
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ LLM –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ schedule format
- –ù–µ –∑–∞–±—ã–≤–∞–π—Ç–µ –ø—Ä–æ timeout (30 —Å–µ–∫—É–Ω–¥)
- –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ –ø—Ä–æ–º–ø—Ç –ª–∏—à–Ω–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** Claude Code
**–î–∞—Ç–∞:** 24.11.2025
**–í–µ—Ä—Å–∏—è:** 1.0
