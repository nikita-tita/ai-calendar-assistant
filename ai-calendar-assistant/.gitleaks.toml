# Gitleaks configuration
# Prevents committing secrets to git
# Run: gitleaks detect --source . --verbose

title = "AI Calendar Assistant Gitleaks Config"

[allowlist]
description = "Allowlist for known safe patterns"
paths = [
    '''\.gitleaks\.toml$''',
    '''\.env\.example$''',
    '''\.env\.template$''',
]

# Allow REDACTED placeholders
regexes = [
    '''\*\*\*REDACTED''',
    '''\$SERVER_PASSWORD''',
    '''\$ADMIN_PASSWORD''',
]

# Custom rules for our secrets
[[rules]]
id = "telegram-bot-token"
description = "Telegram Bot Token"
regex = '''\d{10}:[A-Za-z0-9_-]{35}'''
tags = ["telegram", "token"]

[[rules]]
id = "yandex-api-key"
description = "Yandex API Key"
regex = '''AQVN[A-Za-z0-9_-]{36,}'''
tags = ["yandex", "api-key"]

[[rules]]
id = "generic-secret"
description = "Generic Secret Key"
regex = '''(?i)(secret|password|token|key)[\s]*[=:][\s]*['"]?[A-Za-z0-9_-]{20,}['"]?'''
tags = ["secret", "key"]
