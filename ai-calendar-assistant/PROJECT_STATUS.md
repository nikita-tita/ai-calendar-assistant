# Статус проекта: AI Calendar Assistant

**Дата снимка:** 2026-01-11
**Версия документа:** 1.1

---

## Общая информация

| Параметр | Значение |
|----------|----------|
| **Название** | AI Calendar Assistant |
| **URL** | https://calendar.housler.ru |
| **Репозиторий** | https://github.com/nikita-tita/ai-calendar-assistant |
| **Сервер** | 95.163.227.26 (reg.ru, Ubuntu 24.04) |
| **Стадия** | Production (с техническим долгом) |
| **Дата запуска** | 2025 |

---

## Цель продукта

**Для кого:** Пользователи Telegram, которым нужен умный календарь.

**Что делает:** Telegram-бот и WebApp для управления календарём и задачами на естественном языке (русский). Использует Yandex GPT для понимания команд типа "Встреча завтра в 15:00".

**Ключевая ценность:** Голосовые и текстовые команды вместо ручного ввода событий.

---

## Текущий объём (что реализовано)

### Функциональность

| Функция | Статус | Примечания |
|---------|--------|------------|
| Создание событий (текст) | Работает | Yandex GPT парсинг |
| Создание событий (голос) | Работает | Yandex SpeechKit |
| Batch-создание событий | Работает | "В 10 встреча, в 11 обед" |
| Повторяющиеся события | Работает | Daily/Weekly/Monthly |
| Обновление событий | Работает | По имени или контексту |
| Удаление событий | Работает | Одиночное и массовое |
| Поиск свободного времени | Работает | find_free_slots |
| Задачи (todos) | Работает | Шифрованное хранение |
| WebApp (календарь) | Работает | Telegram Mini App |
| Admin Panel | Работает | 3-пароля / JWT+2FA |
| Аналитика | Работает | SQLite |
| Property Bot | Отключен | Функционал заморожен |

### Технологический стек

| Компонент | Технология |
|-----------|------------|
| Backend | Python 3.11, FastAPI |
| AI/NLP | Yandex GPT, Yandex SpeechKit |
| Календарь | Radicale (CalDAV) |
| Кэш/Rate Limit | Redis |
| База данных | SQLite (analytics) |
| Шифрование | Fernet |
| Фронтенд | Vanilla JS, Tailwind CSS |
| Контейнеризация | Docker Compose |
| Reverse Proxy | Nginx |

---

## Ограничения

### Технические
- Один инстанс (нет HA)
- SQLite не масштабируется
- Property Bot отключен

### Бизнес
- Только русский язык
- Только Telegram (нет веб-доступа без Telegram)

### Правовые
- Персональные данные хранятся на российском сервере (reg.ru)
- GDPR не применим (только РФ пользователи)

---

## Ключевые сценарии

1. **Создание события голосом:** Пользователь → голосовое → STT → LLM → CalDAV → подтверждение
2. **Просмотр календаря:** Открыть WebApp → API → список событий → календарь-вид
3. **Создание задачи:** "Купить молоко" (без времени) → LLM определяет TODO → шифрованное хранение
4. **Утреннее напоминание:** Cron → список событий дня → Telegram сообщение

---

## Интеграции

| Внешняя система | Тип интеграции | Статус |
|-----------------|----------------|--------|
| Telegram Bot API | Webhook | Работает |
| Yandex GPT | REST API | Работает |
| Yandex SpeechKit | REST API | Работает |
| Radicale CalDAV | HTTP | Работает |
| Redis | TCP | Работает |
| Google Calendar | OAuth2 | Не реализовано |

---

## Открытые вопросы и технический долг

### Критический (Blocker) — ВСЕ ЗАКРЫТЫ ✅
1. ~~**SEC-001:** Секреты в Git истории~~ — DONE (2026-01-10, BFG cleanup)
2. ~~**SEC-002:** SQL Injection~~ — DONE (2026-01-10, параметризованные запросы)
3. ~~**INFRA-001:** Бэкапы~~ — DONE (2026-01-10, cron 03:00)

### Высокий (High) — 1 открытый (из 13)
4. ~~**SEC-003:** XSS уязвимости~~ — DONE (2026-01-09, safeId())
5. ~~**BIZ-001:** Race condition in cache~~ — DONE (2026-01-09, threading.Lock)
6. ~~**TEST-001/002:** Тестовое покрытие~~ — DONE (110+ тестов, ~25%)
7. ~~**ARCH-001:** extract_event()~~ — DONE (2026-01-11, 500→131 строк)
8. ~~**ARCH-002:** handle_callback_query()~~ — DONE (2026-01-11, 371→34 строки)
9. ~~**INFRA-002:** Prometheus + Grafana~~ — DONE (2026-01-11)
10. **UX-001:** Light theme — TODO

### Средний (Medium) — 17 в backlog
- ~~**PERF-001:** Memory leak~~ — DONE (уже исправлено)
- ~~**DOC-001:** API Reference~~ — DONE (2026-01-11, 1930 строк)
- ~~**DOC-002:** Runbooks~~ — DONE (2026-01-11, 755 строк)
- ~~**INFRA-003:** Centralized logging~~ — DONE (2026-01-11, Loki)

**Полный список:** см. `BACKLOG.md` (23 done / 45 всего)

---

## Риски

| Риск | Вероятность | Влияние | Владелец |
|------|-------------|---------|----------|
| Потеря данных (нет бэкапов) | Высокая | Критическое | DevOps |
| Security breach (секреты в Git) | Высокая | Критическое | Security |
| Downtime без диагностики (нет мониторинга) | Средняя | Высокое | DevOps |
| Regression при изменениях (мало тестов) | Высокая | Среднее | QA |

---

## Метрики проекта

| Метрика | Значение |
|---------|----------|
| Строк кода (Python) | ~18,500 |
| Строк тестов | ~5,000+ |
| Тестовое покрытие | ~25% |
| Документация (файлов) | 90+ |
| Документация (строк) | ~55,000 |
| Всего задач в бэклоге | 45 |
| Выполнено (Done) | **24 (53%)** |
| Критических (Blocker) | **0** ✅ |
| Открытых High | 1 |

---

## Следующие шаги

1. ~~**Неделя 1:** Закрыть Blocker-проблемы~~ — ✅ DONE (все 10 закрыты)
2. **Текущий приоритет:** Закрыть оставшиеся High-проблемы (1 из 13):
   - ~~INFRA-002: Prometheus + Grafana~~ — ✅ DONE
   - ~~ARCH-001: Рефакторинг extract_event()~~ — ✅ DONE
   - ~~ARCH-002: Рефакторинг handle_callback_query()~~ — ✅ DONE
   - UX-001: Light theme fix — TODO (последний High!)
3. **Месяц 2-3:** Backlog (17 Medium + 3 Low)

---

*Источник правды: BACKLOG.md (версия 2.2)*
