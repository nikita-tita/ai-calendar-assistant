# Риски и блокеры проекта

**Последнее обновление:** 2026-01-09

---

## Активные блокеры

| ID | Блокер | Что блокирует | Владелец | Дедлайн | Статус |
|----|--------|---------------|----------|---------|--------|
| BLK-001 | Секреты в Git истории | Безопасность production | DevOps | 2026-01-10 | Открыт |
| BLK-002 | Нет автоматических бэкапов | Защита данных | DevOps | 2026-01-10 | Открыт |

### BLK-001: Секреты в Git истории

**Описание:** `.env` файл с production credentials находится в Git истории. Любой с доступом к репозиторию может получить все секреты.

**Влияние:**
- Telegram Bot может быть захвачен
- Yandex GPT API ключи могут быть использованы для спама
- База данных может быть скомпрометирована
- Шифрование данных может быть расшифровано

**План снятия:**
1. Ротировать все секреты немедленно
2. Удалить .env из Git истории (BFG)
3. Добавить secrets scanning в CI

**Владелец:** DevOps
**Дедлайн:** 2026-01-10

---

### BLK-002: Нет автоматических бэкапов

**Описание:** backup-calendar.sh существует, но не добавлен в cron. Данные пользователей уже были потеряны при удалении старого сервера.

**Влияние:**
- Полная потеря данных при сбое сервера
- Невозможность восстановления после инцидента
- Потеря доверия пользователей

**План снятия:**
1. Добавить backup в cron (15 минут)
2. Включить GPG encryption
3. Настроить upload в cloud storage
4. Протестировать restore

**Владелец:** DevOps
**Дедлайн:** 2026-01-10

---

## Риски

| ID | Риск | Вероятность | Влияние | Митигация | Владелец | Статус |
|----|------|-------------|---------|-----------|----------|--------|
| RSK-001 | Security breach через SQL Injection | Высокая | Критическое | SEC-002 задача | Backend | Открыт |
| RSK-002 | XSS атака через event title | Средняя | Высокое | SEC-003 задача | Frontend | Открыт |
| RSK-003 | Downtime без диагностики | Высокая | Высокое | INFRA-002 задача | DevOps | Открыт |
| RSK-004 | Regression при изменениях | Высокая | Среднее | TEST-001/002 задачи | QA | Открыт |
| RSK-005 | Memory exhaustion | Средняя | Среднее | PERF-001/002 задачи | Backend | Открыт |
| RSK-006 | Data corruption при concurrent access | Средняя | Высокое | BIZ-001 задача | Backend | Открыт |

---

### RSK-001: Security breach через SQL Injection

**Описание:** analytics_service.py использует f-strings для SQL запросов. Атакующий может извлечь или модифицировать данные всех пользователей.

**Вероятность:** Высокая (уязвимость существует)
**Влияние:** Критическое (утечка всех данных)

**Митигация:**
- [x] Проблема идентифицирована (SEC-002)
- [ ] Все SQL параметризованы
- [ ] Audit всех SQL в проекте
- [ ] Security test suite

**Связанная задача:** SEC-002
**Владелец:** Backend
**Целевая дата закрытия:** 2026-01-11

---

### RSK-002: XSS атака через event title

**Описание:** Frontend использует onclick с string interpolation и innerHTML. Атакующий может внедрить JavaScript через название события.

**Вероятность:** Средняя (требует создания события)
**Влияние:** Высокое (session hijacking)

**Митигация:**
- [x] Проблема идентифицирована (SEC-003)
- [ ] onclick → data attributes
- [ ] CSP header добавлен
- [ ] OWASP ZAP scan

**Связанная задача:** SEC-003
**Владелец:** Frontend
**Целевая дата закрытия:** 2026-01-12

---

### RSK-003: Downtime без диагностики

**Описание:** Prometheus метрики определены, но не инструментированы. При инциденте невозможно понять причину.

**Вероятность:** Высокая (инциденты случаются)
**Влияние:** Высокое (MTTR увеличен)

**Митигация:**
- [x] Проблема идентифицирована (INFRA-002)
- [ ] Prometheus настроен
- [ ] Grafana dashboards созданы
- [ ] Alert rules настроены

**Связанная задача:** INFRA-002
**Владелец:** DevOps
**Целевая дата закрытия:** 2026-01-20

---

### RSK-004: Regression при изменениях

**Описание:** Тестовое покрытие 13%. Critical paths (API, auth) не покрыты. Изменения могут сломать production незаметно.

**Вероятность:** Высокая (каждое изменение — риск)
**Влияние:** Среднее (функционал может сломаться)

**Митигация:**
- [x] Проблема идентифицирована (TEST-001/002)
- [ ] API endpoints покрыты
- [ ] Security code покрыт
- [ ] CI enforces coverage

**Связанные задачи:** TEST-001, TEST-002, TEST-003
**Владелец:** QA
**Целевая дата закрытия:** 2026-01-25

---

### RSK-005: Memory exhaustion

**Описание:** webapp_cache не очищается, conversation_history растёт. При длительной работе память может закончиться.

**Вероятность:** Средняя (зависит от нагрузки)
**Влияние:** Среднее (сервис падает)

**Митигация:**
- [x] Проблема идентифицирована (PERF-001/002)
- [ ] Cache cleanup включён
- [ ] Memory profiling
- [ ] Alerting на memory usage

**Связанные задачи:** PERF-001, PERF-002
**Владелец:** Backend
**Целевая дата закрытия:** 2026-01-15

---

### RSK-006: Data corruption при concurrent access

**Описание:** Calendar cache не защищён lock'ом. Concurrent requests могут вызвать inconsistent data.

**Вероятность:** Средняя (при нагрузке)
**Влияние:** Высокое (пользователь видит неправильные данные)

**Митигация:**
- [x] Проблема идентифицирована (BIZ-001)
- [ ] Cache lock используется
- [ ] Concurrent tests

**Связанная задача:** BIZ-001
**Владелец:** Backend
**Целевая дата закрытия:** 2026-01-11

---

## Закрытые риски/блокеры

*Пока пусто — записи будут добавляться по мере закрытия*

---

## Escalation процедура

1. **Новый блокер:** Создать запись в этом файле, назначить владельца
2. **Блокер > 24 часов:** Escalate к техлиду
3. **Критический риск реализовался:** Incident response по RUNBOOKS.md

---

*Источник правды для рисков и блокеров*
