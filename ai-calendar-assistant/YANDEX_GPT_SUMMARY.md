# üìä –Ø–Ω–¥–µ–∫—Å GPT - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–ü—Ä–æ–µ–∫—Ç:** AI Calendar Assistant
**–î–∞—Ç–∞:** 24 –Ω–æ—è–±—Ä—è 2025

---

## üéØ –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å
- **API:** Yandex GPT (YandexGPT Foundation Models)
- **Endpoint:** `https://llm.api.cloud.yandex.net/foundationModels/v1/completion`
- **–ú–æ–¥–µ–ª—å:** `yandexgpt` (–∏–ª–∏ `yandexgpt-lite` –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- **Temperature:** 0.2 (–Ω–∏–∑–∫–∞—è –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏)
- **Max Tokens:** 2000

### –§–∞–π–ª—ã –∫–æ–¥–∞

1. **`app/services/llm_agent_yandex.py`** (1259 —Å—Ç—Ä–æ–∫)
   - –ö–ª–∞—Å—Å `LLMAgentYandex` - –æ—Å–Ω–æ–≤–Ω–æ–π –∞–≥–µ–Ω—Ç
   - –ú–µ—Ç–æ–¥ `extract_event()` - –≥–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
   - –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç Yandex GPT
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏–Ω—Ç–µ–Ω—Ç–æ–≤

2. **`app/services/telegram_handler.py`** (1500+ —Å—Ç—Ä–æ–∫)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∫ LLM Agent
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ conversation history
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (create/update/delete)

3. **`app/config.py`** (123 —Å—Ç—Ä–æ–∫–∏)
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Yandex GPT API
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ timezone

---

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

### –ü—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞
```
Telegram ‚Üí TelegramHandler ‚Üí LLMAgentYandex ‚Üí Yandex GPT API ‚Üí EventDTO ‚Üí Action
```

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç: "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
   ‚Üì
2. TelegramHandler._handle_text()
   ‚Üì
3. –ó–∞–≥—Ä—É–∑–∫–∞ existing_events –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
   ‚Üì
4. LLMAgentYandex.extract_event()
   ‚Üì
5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞:
   - –ë–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (3500 —Ç–æ–∫–µ–Ω–æ–≤)
   - –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –∏ timezone
   - Existing events (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ‚Üì
6. POST request –∫ Yandex GPT API
   {
     "modelUri": "gpt://folder_id/yandexgpt/latest",
     "completionOptions": {"temperature": 0.2, "maxTokens": 2000},
     "messages": [{"role": "system", "text": full_prompt}]
   }
   ‚Üì
7. Yandex GPT –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON:
   {
     "intent": "create",
     "title": "–í—Å—Ç—Ä–µ—á–∞",
     "start_time": "2025-11-25T15:00:00+03:00",
     ...
   }
   ‚Üì
8. –ü–∞—Ä—Å–∏–Ω–≥ –≤ EventDTO
   ‚Üì
9. TelegramHandler._handle_create()
   ‚Üì
10. CalendarService.create_event()
   ‚Üì
11. –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: "‚úÖ –ó–∞–ø–∏—Å–∞–ª"
```

---

## üìù –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

### –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–∫—Ä–∞—Ç–∫–æ)

```
–í—ã - –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.
–ó–∞–¥–∞—á–∞: –ø–æ–Ω–∏–º–∞—Ç—å natural language –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

–¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π (intent):
- create: —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –° –≤—Ä–µ–º–µ–Ω–µ–º
- todo: —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –ë–ï–ó –≤—Ä–µ–º–µ–Ω–∏
- query: –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
- update/delete: –∏–∑–º–µ–Ω–∏—Ç—å/—É–¥–∞–ª–∏—Ç—å
- create_recurring: –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è
- batch_confirm: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- clarify: –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É—Ç–æ—á–Ω–µ–Ω–∏–µ

–í–ê–ñ–ù–û:
- –ï—Å–ª–∏ –ù–ï–¢ –≤—Ä–µ–º–µ–Ω–∏ ‚Üí intent="todo"
- –ï—Å–ª–∏ –ï–°–¢–¨ –≤—Ä–µ–º—è ‚Üí intent="create"
- –í—Å–µ–≥–¥–∞ ISO 8601 format
- –ò—Å–ø–æ–ª—å–∑—É–π –¢–ï–ö–£–©–£–Æ –î–ê–¢–£ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
```

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ø—Ä–∏–º–µ—Ä)

```
–¢–ï–ö–£–©–ê–Ø –î–ê–¢–ê: 24.11.2025 15:30 (Europe/Moscow, UTC+03:00), –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ

–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—ã:
- "–∑–∞–≤—Ç—Ä–∞" = 25.11.2025
- "–ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞" = 26.11.2025

–ë–ª–∏–∂–∞–π—à–∏–µ –¥–Ω–∏:
- "–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫" = 25.11.2025
- "–≤—Ç–æ—Ä–Ω–∏–∫" = 26.11.2025
...

–ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–û —ç—Ç–∏ –¥–∞—Ç—ã!
```

---

## üéØ –¢–∏–ø—ã –∏–Ω—Ç–µ–Ω—Ç–æ–≤

| Intent | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è |
|--------|-------------------|------------------|
| **CREATE** | –°–æ–±—ã—Ç–∏–µ + –≤—Ä–µ–º—è | title, start_time |
| **TODO** | –ó–∞–¥–∞—á–∞ –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏ | title |
| **QUERY** | "–ß—Ç–æ —É –º–µ–Ω—è..." | query_date_start |
| **UPDATE** | "–ü–µ—Ä–µ–Ω–µ—Å–∏..." | event_id, –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ |
| **DELETE** | "–£–¥–∞–ª–∏..." | event_id |
| **CREATE_RECURRING** | "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å..." | recurrence_type, title |
| **BATCH_CONFIRM** | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è | batch_actions[] |
| **DELETE_BY_CRITERIA** | "–£–¥–∞–ª–∏ –≤—Å–µ..." | delete_criteria_title_contains |
| **FIND_FREE_SLOTS** | "–ö–æ–≥–¥–∞ —Å–≤–æ–±–æ–¥–µ–Ω..." | query_date_start |
| **CLARIFY** | –ù—É–∂–Ω–æ —É—Ç–æ—á–Ω–µ–Ω–∏–µ | clarify_question |

---

## üí¨ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–±—ã—Ç–∏–µ
```
User: "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"

LLM Response:
{
  "intent": "create",
  "title": "–í—Å—Ç—Ä–µ—á–∞",
  "start_time": "2025-11-25T15:00:00+03:00",
  "end_time": "2025-11-25T16:00:00+03:00"
}

Bot: "‚úÖ –ó–∞–ø–∏—Å–∞–ª\n25 –Ω–æ—è–±—Ä—è 15:00 ‚Ä¢ –í—Å—Ç—Ä–µ—á–∞"
```

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–¥–∞—á–∞
```
User: "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É"

LLM Response:
{
  "intent": "todo",
  "title": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É"
}

Bot: "‚úÖ –ó–∞–ø–∏—Å–∞–ª –∑–∞–¥–∞—á—É\nüìù –ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É"
```

### –ü—Ä–∏–º–µ—Ä 3: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
```
User: "–í 17 –≤—Å—Ç—Ä–µ—á–∞, –ø–æ—Ç–æ–º –≤ 19 —É–∂–∏–Ω"

LLM Response:
{
  "intent": "batch_confirm",
  "batch_actions": [
    {"intent": "create", "title": "–í—Å—Ç—Ä–µ—á–∞", "start_time": "17:00"},
    {"intent": "create", "title": "–£–∂–∏–Ω", "start_time": "19:00"}
  ]
}

Bot: "üìÖ –°–æ–∑–¥–∞—Ç—å 2 —Å–æ–±—ã—Ç–∏—è:\n‚Ä¢ 17:00 - –í—Å—Ç—Ä–µ—á–∞\n‚Ä¢ 19:00 - –£–∂–∏–Ω\n[–°–æ–∑–¥–∞—Ç—å] [–û—Ç–º–µ–Ω–∞]"
```

---

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ schedule format
```python
# –î–û –≤—ã–∑–æ–≤–∞ LLM
schedule_dto = self._detect_schedule_format(user_text, timezone)
if schedule_dto:
    return schedule_dto  # –≠–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤
```

**–ü–∞—Ç—Ç–µ—Ä–Ω:**
```
—Ç–∞–π–º–∏–Ω–≥ –Ω–∞ 25 –Ω–æ—è–±—Ä—è:
12:45-13:00 –ü—Ä–∏–µ–∑–¥
13:00-13:30 –ö–æ—Ñ–µ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–∞—Ä—Å–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –±–µ–∑ LLM ‚Üí —ç–∫–æ–Ω–æ–º–∏—è ~2000 —Ç–æ–∫–µ–Ω–æ–≤.

### 2. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ event_id enum

```python
event_id_enum = ["none"]
if existing_events:
    for event in existing_events:
        event_id_enum.append(event.id)
```

LLM –≤–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ ID –∏ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–ª—è UPDATE/DELETE.

### 3. Conversation history –¥–ª—è clarify

```python
if last_message.intent == CLARIFY:
    history = [user_request, clarify_question]
else:
    history = []  # –û—á–∏—â–∞–µ–º –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞
```

–ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–∏–∞–ª–æ–≥ —É—Ç–æ—á–Ω–µ–Ω–∏—è.

### 4. Existing events –≤ –ø—Ä–æ–º–ø—Ç–µ

```xml
<existing_calendar_events>
Event: –í—Å—Ç—Ä–µ—á–∞ —Å –õ–µ–Ω–æ–π
Time: 24.11.2025 15:00
ID: abc-123

Event: –ü–æ–∫–∞–∑ –∫–≤–∞—Ä—Ç–∏—Ä—ã
Time: 25.11.2025 10:00
ID: xyz-456
</existing_calendar_events>

CRITICAL: Copy exact ID for update/delete
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### .env —Ñ–∞–π–ª
```bash
YANDEX_GPT_API_KEY=your_api_key
YANDEX_GPT_FOLDER_ID=your_folder_id
DEFAULT_TIMEZONE=Europe/Moscow
```

### API Request
```python
headers = {
    "Authorization": f"Api-Key {api_key}",
    "Content-Type": "application/json"
}

payload = {
    "modelUri": f"gpt://{folder_id}/yandexgpt/latest",
    "completionOptions": {
        "stream": False,
        "temperature": 0.2,
        "maxTokens": 2000
    },
    "messages": [
        {"role": "system", "text": full_prompt}
    ]
}

response = requests.post(api_url, headers=headers, json=payload, timeout=30)
```

---

## üîß –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### API Errors
```python
if response.status_code != 200:
    logger.error("yandex_gpt_api_error")
    raise Exception(f"API error: {response.status_code}")
```

### JSON Parse Errors
```python
try:
    json_data = json.loads(extract_json(response_text))
except:
    return EventDTO(intent=CLARIFY, clarify_question="–ù–µ —Ä–∞–∑–æ–±—Ä–∞–ª. –ü–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä—É–π—Ç–µ.")
```

### Fallback –Ω–∞ clarify
–ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `intent="clarify"`

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (structlog)
```python
logger.info("llm_extract_start", user_text=text)
logger.info("yandex_gpt_api_call", event_id_enum=enum)
logger.info("yandex_gpt_raw_response", result=text)
logger.info("llm_extract_success", intent=dto.intent)
```

### Analytics (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```python
analytics_service.log_action(
    user_id=user_id,
    action_type="text_message",
    details=text[:200]
)
```

---

## üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤

- üá∑üá∫ –†—É—Å—Å–∫–∏–π (ru)
- üá¨üáß –ê–Ω–≥–ª–∏–π—Å–∫–∏–π (en)
- üá™üá∏ –ò—Å–ø–∞–Ω—Å–∫–∏–π (es)
- üá∏üá¶ –ê—Ä–∞–±—Å–∫–∏–π (ar)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞:
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ —è–∑—ã–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞—Ç
- `clarify_question` –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —è–∑—ã–∫–µ

---

## üéØ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **Schedule format preprocessing** ‚Üí —ç–∫–æ–Ω–æ–º–∏—è ~2000 —Ç–æ–∫–µ–Ω–æ–≤
2. **Temperature 0.2** ‚Üí —Ç–æ—á–Ω—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
3. **maxTokens 2000** ‚Üí –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
4. **Conversation history** ‚Üí —Ç–æ–ª—å–∫–æ –¥–ª—è clarify –¥–∏–∞–ª–æ–≥–æ–≤
5. **–õ–æ–∫–∞–ª—å–Ω—ã–π –∫–µ—à timezone** ‚Üí –±—ã—Å—Ç—Ä–µ–µ

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–æ–∫–µ–Ω—ã |
|-----------|--------|
| –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç | ~3500 |
| –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç | ~1000 |
| Existing events (10 —à—Ç) | ~200-500 |
| Conversation history | ~100-300 |
| **–ò—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å** | **~4500-5500** |
| | |
| –û—Ç–≤–µ—Ç (simple) | ~100-200 |
| –û—Ç–≤–µ—Ç (batch) | ~500-1500 |

**–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞:** ~6000-7000 —Ç–æ–∫–µ–Ω–æ–≤ (input + output)

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **YANDEX_GPT_ARCHITECTURE.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
2. **YANDEX_GPT_PROMPTS_EXAMPLES.md** - –ø—Ä–∏–º–µ—Ä—ã –≤—Å–µ—Ö –ø—Ä–æ–º–ø—Ç–æ–≤
3. **app/services/llm_agent_yandex.py** - –∫–æ–¥ –∞–≥–µ–Ω—Ç–∞
4. **app/services/telegram_handler.py** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üìû Quick Reference

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```python
await llm_agent.extract_event(
    user_text="–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 15:00",
    user_id="123456",
    timezone="Europe/Moscow"
)
# ‚Üí EventDTO(intent=CREATE, title="–í—Å—Ç—Ä–µ—á–∞", ...)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
```python
if event_dto.intent == IntentType.CREATE:
    await calendar_service.create_event(user_id, event_dto)
elif event_dto.intent == IntentType.TODO:
    await todos_service.create_todo(user_id, event_dto)
elif event_dto.intent == IntentType.CLARIFY:
    await bot.reply(event_dto.clarify_question)
```

---

## ‚úÖ Checklist –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ intent:

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ enum IntentType
- [ ] –û–±–Ω–æ–≤–∏—Ç—å base_system_prompt
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–º–ø—Ç
- [ ] –°–æ–∑–¥–∞—Ç—å handler –º–µ—Ç–æ–¥ (_handle_new_intent)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –≤ _handle_text()
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

**–°–æ–∑–¥–∞–Ω–æ:** Claude Code
**–î–∞—Ç–∞:** 24.11.2025
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üéâ –ò—Ç–æ–≥

AI Calendar Assistant –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Yandex GPT** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π LLM –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º.

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –†–æ—Å—Å–∏–∏ –±–µ–∑ VPN
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 4 —è–∑—ã–∫–æ–≤
- ‚úÖ –°–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (batch, recurring, clarify)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CalDAV –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
- ‚úÖ TODO –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –∑–∞–¥–∞—á –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –£–º–Ω–æ–µ –ø–µ—Ä–µ—Å–ø—Ä–∞—à–∏–≤–∞–Ω–∏–µ (clarify)

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 1-3 —Å–µ–∫—É–Ω–¥—ã
- –¢–æ—á–Ω–æ—Å—Ç—å intent detection: ~95%
- –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞: ~6000 —Ç–æ–∫–µ–Ω–æ–≤

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 1000+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Rate limiting —á–µ—Ä–µ–∑ Redis
- Analytics –¥–ª—è –º–µ—Ç—Ä–∏–∫
- Structured logging

üöÄ **–ì–æ—Ç–æ–≤–æ –∫ production!**
