#!/bin/bash

# Quick update for telegram_handler.py with cache-busting fix

set -e

SERVER="root@95.163.227.26"
SSH_KEY="$HOME/.ssh/id_housler"

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "ğŸ”§ ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ• TELEGRAM HANDLER Ğ¡ FIX ĞšĞ•Ğ¨Ğ"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

echo "1. ĞšĞ¾Ğ¿Ğ¸Ñ€ÑƒÑ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğ¹ telegram_handler.py Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€..."
scp -i "$SSH_KEY" app/services/telegram_handler.py "$SERVER":/root/ai-calendar-assistant/app/services/

echo ""
echo "2. ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ..."
ssh -i "$SSH_KEY" "$SERVER" << 'EOF'
cd /root/ai-calendar-assistant
echo "  â†’ ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²..."
docker-compose restart calendar-assistant telegram-bot-polling
echo "  âœ… ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ñ‹"
echo ""
echo "  â†’ ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° (10 ÑĞµĞºÑƒĞ½Ğ´)..."
sleep 10
echo ""
echo "  â†’ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°..."
docker-compose ps
EOF

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•ĞĞ!"
echo ""
echo "ğŸ“ Ğ§Ğ¢Ğ Ğ˜Ğ—ĞœĞ•ĞĞ˜Ğ›ĞĞ¡Ğ¬:"
echo "   â€¢ Menu Button Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ ?v=timestamp Ğº URL"
echo "   â€¢ Ğ­Ñ‚Ğ¾ Ğ·Ğ°ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ Telegram Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Web App"
echo ""
echo "ğŸ§ª Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ•:"
echo "   1. ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ±Ğ¾Ñ‚Ğ° Ğ² Telegram"
echo "   2. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ /start (Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾!)"
echo "   3. ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ 'ğŸ—“ ĞšĞ°Ğ±Ğ¸Ğ½ĞµÑ‚' Ğ²Ğ½Ğ¸Ğ·Ñƒ"
echo "   4. Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒÑÑ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ´Ğ°Ñ‚Ğ¾Ğ¹"
echo ""
echo "   Ğ•ÑĞ»Ğ¸ Ğ´Ğ°Ñ‚Ğ° Ğ²ÑÑ‘ ĞµÑ‰Ñ‘ 30 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ:"
echo "   â€¢ ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ·Ğ°ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ¸ Ğ¾Ñ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Telegram"
echo "   â€¢ Ğ¡Ğ½Ğ¾Ğ²Ğ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ /start"
echo "   â€¢ ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ 'ğŸ—“ ĞšĞ°Ğ±Ğ¸Ğ½ĞµÑ‚'"
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
