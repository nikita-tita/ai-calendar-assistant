# ‚úÖ API –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≥–æ—Ç–æ–≤–æ!

**–î–∞—Ç–∞:** 10 –æ–∫—Ç—è–±—Ä—è 2025, 18:32 MSK

---

## üéâ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω REST API –¥–ª—è —Å–æ–±—ã—Ç–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è

–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ endpoints:

| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-----|----------|
| GET | `/api/events/{user_id}` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| POST | `/api/events/{user_id}` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ |
| PUT | `/api/events/{user_id}/{event_id}` | –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ |
| DELETE | `/api/events/{user_id}/{event_id}` | –£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ |
| GET | `/api/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API |

### 2. –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã

–ë–æ—Ç —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ **–≥–∏–±—Ä–∏–¥–Ω–æ–º —Ä–µ–∂–∏–º–µ**:
- ‚úÖ Telegram Bot (polling) - –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- ‚úÖ FastAPI Web Server (–ø–æ—Ä—Ç 8000) - –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 3. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

–í—Å–µ URL –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω—ã —Å Railway –Ω–∞ REG.RU:
```javascript
// –ë—ã–ª–æ:
https://calendar-bot-production-e1ac.up.railway.app/events/

// –°—Ç–∞–ª–æ:
http://95.163.227.26:8000/api/events/
```

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### API Endpoints

**–ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è:**
```bash
curl http://95.163.227.26:8000/api/events/USER_ID?start=2025-10-10T00:00:00&end=2025-11-10T00:00:00
```

**–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ:**
```bash
curl -X POST http://95.163.227.26:8000/api/events/USER_ID \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–í—Å—Ç—Ä–µ—á–∞",
    "start": "2025-10-15T14:00:00",
    "end": "2025-10-15T15:00:00",
    "location": "–û—Ñ–∏—Å",
    "description": "–í–∞–∂–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞"
  }'
```

**–û–±–Ω–æ–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ:**
```bash
curl -X PUT http://95.163.227.26:8000/api/events/USER_ID/EVENT_ID \
  -H "Content-Type: application/json" \
  -d '{
    "title": "–û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
    "start": "2025-10-15T15:00:00",
    "end": "2025-10-15T16:00:00"
  }'
```

**–£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ:**
```bash
curl -X DELETE http://95.163.227.26:8000/api/events/USER_ID/EVENT_ID
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

FastAPI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
- **Swagger UI:** http://95.163.227.26:8000/docs
- **ReDoc:** http://95.163.227.26:8000/redoc

---

## üìä –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```
CONTAINER ID   STATUS              PORTS
telegram-bot   Up (healthy)        0.0.0.0:8000->8000/tcp
radicale       Up (healthy)        0.0.0.0:5232->5232/tcp
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏

```bash
# API —Ä–∞–±–æ—Ç–∞–µ—Ç
$ curl http://95.163.227.26:8000/api/health
{"status":"ok","radicale_connected":true}

# Events endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
$ curl http://95.163.227.26:8000/api/events/123
[]

# Telegram Bot —Ä–∞–±–æ—Ç–∞–µ—Ç
$ docker logs telegram-bot --tail 5
Bot is running! Press Ctrl+C to stop.
Daily reminders started (9:00 morning, 20:00 evening)
Uvicorn running on http://0.0.0.0:8000
```

---

## üîê –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Telegram Mini App (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
    ‚Üì
http://95.163.227.26:8000/api/events/{user_id}
    ‚Üì
FastAPI Router (app/routers/events.py)
    ‚Üì
RadicaleService (app/services/calendar_radicale.py)
    ‚Üì
Radicale CalDAV Server (http://radicale:5232)
    ‚Üì
–ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ Telegram ID)
```

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

‚úÖ **–í–°–Å –°–ò–ù–•–†–û–ù–ò–ó–ò–†–û–í–ê–ù–û!**

1. **Telegram Bot** ‚Üí –ü–∏—à–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Radicale CalDAV
2. **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** ‚Üí –ß–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ API ‚Üí Radicale CalDAV
3. **–û–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –û–î–ò–ù –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö** (Radicale)

–ü–æ—ç—Ç–æ–º—É:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ - –æ–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è –≤ –≤–µ–±-–∞–ø–ø
- –ï—Å–ª–∏ —Å–æ–∑–¥–∞—ë—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∞–ø–ø - –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–ø–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ –±–æ—Ç–µ
- –í—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!

---

## üéØ –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

### 1. –í –≤–µ–±-–∞–ø–ø –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞?

‚úÖ **–î–ê!** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç `user_id` –æ—Ç Telegram WebApp API –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```javascript
// –í index.html
const tg = window.Telegram.WebApp;
const userId = tg.initDataUnsafe?.user?.id;

// –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–±—ã—Ç–∏—è –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
fetch(`http://95.163.227.26:8000/api/events/${userId}`)
```

### 2. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –≤ –≤–µ–±-–∞–ø–ø –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –±–æ—Ç–∞?

‚úÖ **–î–ê!** –û–±–∞ (–±–æ—Ç –∏ –≤–µ–±-–∞–ø–ø) —Ä–∞–±–æ—Ç–∞—é—Ç —Å –æ–¥–Ω–∏–º Radicale –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏–µ –≤ –±–æ—Ç–µ:
Telegram ‚Üí Bot ‚Üí Radicale (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–µ–±-–∞–ø–ø:
Web App ‚Üí API ‚Üí Radicale (—á–∏—Ç–∞–µ—Ç) ‚Üí –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
```

### 3. –í—Å—ë —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –º–µ–∂–¥—É —Å–æ–±–æ–π?

‚úÖ **–î–ê!** Radicale - —ç—Ç–æ –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã (Single Source of Truth):

- –ë–æ—Ç —Å–æ–∑–¥–∞–ª —Å–æ–±—ã—Ç–∏–µ ‚Üí –°–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –≤ Radicale
- –í–µ–±-–∞–ø–ø –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ ‚Üí –ß–∏—Ç–∞–µ—Ç –∏–∑ Radicale
- –í–µ–±-–∞–ø–ø —Å–æ–∑–¥–∞–ª —Å–æ–±—ã—Ç–∏–µ ‚Üí –°–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –≤ Radicale
- –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ ‚Üí –ß–∏—Ç–∞–µ—Ç –∏–∑ Radicale

**–í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!**

### 4. –ë–æ—Ç —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç? –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

‚úÖ **–î–ê!** –ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ REG.RU:
- Telegram Bot –∞–∫—Ç–∏–≤–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
- FastAPI —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
- Radicale —Ä–∞–±–æ—Ç–∞–µ—Ç
- –í—Å—ë –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ REG.RU

–ú–æ–∂–µ—Ç–µ **–ê–ö–¢–ò–í–ù–û –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨**!

---

## üåê –°—Å—ã–ª–∫–∏

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- **Telegram Bot:** –ù–∞–π–¥–∏—Ç–µ –ø–æ —Ç–æ–∫–µ–Ω—É `8378762774:AAE...`
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** http://95.163.227.26 (—Å–µ–π—á–∞—Å)
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Å–ª–µ DNS):** https://—ç—Ç–æ–Ω–µ—Å–∞–º—ã–π–¥–ª–∏–Ω–Ω—ã–π–¥–æ–º–µ–Ω.—Ä—Ñ
- **API:** http://95.163.227.26:8000/api/
- **API Docs:** http://95.163.227.26:8000/docs
- **Radicale:** http://95.163.227.26:5232

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@95.163.227.26

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç–∞—Ç—É—Å
cd /root/ai-calendar-assistant
docker-compose -f docker-compose.hybrid.yml ps

# –õ–æ–≥–∏ –±–æ—Ç–∞
docker logs telegram-bot -f

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose -f docker-compose.hybrid.yml restart
```

---

## üìù –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ REG.RU

- `/root/ai-calendar-assistant/app/routers/events.py` - API router
- `/root/ai-calendar-assistant/run_hybrid.py` - –ì–∏–±—Ä–∏–¥–Ω—ã–π –∑–∞–ø—É—Å–∫
- `/root/ai-calendar-assistant/Dockerfile.hybrid` - Docker –æ–±—Ä–∞–∑
- `/root/ai-calendar-assistant/docker-compose.hybrid.yml` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –õ–æ–∫–∞–ª—å–Ω–æ

- `app/routers/events.py` - REST API endpoints
- `run_hybrid.py` - –°–∫—Ä–∏–ø—Ç –≥–∏–±—Ä–∏–¥–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- `Dockerfile.hybrid` - Docker —Ñ–∞–π–ª
- `docker-compose.hybrid.yml` - Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `calendar-webapp/index.html` - –û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
REG.RU VPS (95.163.227.26)
‚îÇ
‚îú‚îÄ‚îÄ Nginx (–ø–æ—Ä—Ç 80, 443)
‚îÇ   ‚îî‚îÄ‚îÄ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ       ‚îî‚îÄ‚îÄ /var/www/calendar/index.html
‚îÇ       ‚îî‚îÄ‚îÄ http://—ç—Ç–æ–Ω–µ—Å–∞–º—ã–π–¥–ª–∏–Ω–Ω—ã–π–¥–æ–º–µ–Ω.—Ä—Ñ
‚îÇ
‚îú‚îÄ‚îÄ Docker Container: telegram-bot (–ø–æ—Ä—Ç 8000)
‚îÇ   ‚îú‚îÄ‚îÄ Telegram Bot (polling)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ FastAPI Web Server
‚îÇ       ‚îî‚îÄ‚îÄ REST API –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ           ‚îú‚îÄ‚îÄ GET /api/events/{user_id}
‚îÇ           ‚îú‚îÄ‚îÄ POST /api/events/{user_id}
‚îÇ           ‚îú‚îÄ‚îÄ PUT /api/events/{user_id}/{event_id}
‚îÇ           ‚îî‚îÄ‚îÄ DELETE /api/events/{user_id}/{event_id}
‚îÇ
‚îî‚îÄ‚îÄ Docker Container: radicale (–ø–æ—Ä—Ç 5232)
    ‚îî‚îÄ‚îÄ CalDAV —Å–µ—Ä–≤–µ—Ä (—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π)
        ‚îî‚îÄ‚îÄ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ user_id
```

**–í–°–Å –ù–ê –û–î–ù–û–ú –°–ï–†–í–ï–†–ï REG.RU! –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è!**

---

**–°—Ç–∞—Ç—É—Å:** üü¢ **–í–°–Å –†–ê–ë–û–¢–ê–ï–¢ –ò –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!**

**–î–∞—Ç–∞:** 2025-10-10 18:32 UTC+3

---
