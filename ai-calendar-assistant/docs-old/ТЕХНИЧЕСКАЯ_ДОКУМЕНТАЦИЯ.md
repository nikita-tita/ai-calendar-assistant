# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: AI Calendar Assistant

**–î–∞—Ç–∞:** 10 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 1.0
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-—Å–∏—Å—Ç–µ–º—ã)
4. [–ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è](#–º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è-–∏–∑–æ–ª—è—Ü–∏—è)
5. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
6. [–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫–∏-–¥–∞–Ω–Ω—ã—Ö)
7. [Use Cases (–°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)](#use-cases)
8. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
9. [–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
10. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**AI Calendar Assistant** - –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –Ω–∞ –±–∞–∑–µ Telegram –±–æ—Ç–∞ —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ —á–µ—Ä–µ–∑:
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫ –≤ Telegram –±–æ—Ç–µ (—Ç–µ–∫—Å—Ç –∏ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
- –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Telegram Mini App)

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≥–æ–ª–æ—Å–æ–º –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–º –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

‚úÖ **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –∏–∑–æ–ª—è—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Telegram –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- CalDAV —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Apple Calendar, Google Calendar)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    REG.RU VPS (95.163.227.26)                ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ                   Nginx (80, 443)                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Telegram Mini App)               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  - SSL —Ç–µ—Ä–º–∏–Ω–∞—Ü–∏—è                                    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                         ‚îÇ                                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ         Docker Container: telegram-bot (8000)        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ      Telegram Bot (Polling Mode)            ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - python-telegram-bot library               ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π            ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π            ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - OpenAI Whisper API (—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)        ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - Anthropic Claude API (NLU)               ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ      FastAPI Web Server (REST API)            ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - GET /api/events/{user_id}                  ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - POST /api/events/{user_id}                 ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - PUT /api/events/{user_id}/{event_id}       ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - DELETE /api/events/{user_id}/{event_id}    ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - CORS –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                    ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                         ‚îÇ CalDAV Protocol                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ      Docker Container: radicale (5232)              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ     Radicale CalDAV Server                   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –•—Ä–∞–Ω–∏–ª–∏—â–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π                      ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ user_id   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ iCalendar (.ics)      ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                         ‚îÇ                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Persistent Volume: radicale_data              ‚îÇ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  /data/collections/                            ‚îÇ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ    ‚îî‚îÄ‚îÄ telegram_USER_ID/                       ‚îÇ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ         ‚îî‚îÄ‚îÄ events.ics                         ‚îÇ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

         ‚Üë                           ‚Üë
         ‚îÇ                           ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Telegram ‚îÇ             ‚îÇ  –í–µ–±-–±—Ä–∞—É–∑–µ—Ä ‚îÇ
    ‚îÇ   User   ‚îÇ             ‚îÇ  (Mini App)  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è |
|-----------|-----------|--------|
| **Backend Framework** | FastAPI | Latest |
| **Telegram Bot** | python-telegram-bot | 21.0+ |
| **NLU/LLM** | Anthropic Claude API | claude-2 |
| **Speech-to-Text** | OpenAI Whisper API | Latest |
| **Calendar Storage** | Radicale CalDAV | Latest |
| **Web Server** | Nginx | 1.18.0 |
| **Container Runtime** | Docker + Docker Compose | Latest |
| **OS** | Ubuntu 22.04 LTS | - |
| **Frontend** | Vanilla JS + Tailwind CSS | - |

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. Telegram Bot (Polling Mode)

**–§–∞–π–ª—ã:**
- `run_hybrid.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- `app/services/telegram_handler.py` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
- `app/services/llm_agent.py` - AI –æ–±—Ä–∞–±–æ—Ç–∫–∞
- `app/services/stt.py` - —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –≥–æ–ª–æ—Å–∞

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–∏—ë–º —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ–∑–¥–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å/–Ω–∞–π—Ç–∏ —Å–æ–±—ã—Ç–∏–µ)
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Radicale —á–µ—Ä–µ–∑ CalDAV

**–ö–æ–º–∞–Ω–¥—ã:**
- `/start` - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/timezone` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞

### 2. FastAPI REST API

**–§–∞–π–ª—ã:**
- `app/main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
- `app/routers/events.py` - API endpoints –¥–ª—è —Å–æ–±—ã—Ç–∏–π
- `app/routers/telegram.py` - Webhook endpoints (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ polling)

**Endpoints:**

```python
GET    /api/events/{user_id}              # –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏—è
       ?start=2025-10-10T00:00:00         # –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞—á–∞–ª—É
       &end=2025-11-10T00:00:00           # –§–∏–ª—å—Ç—Ä –ø–æ –∫–æ–Ω—Ü—É

POST   /api/events/{user_id}              # –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ
       Body: {
         "title": "–í—Å—Ç—Ä–µ—á–∞",
         "start": "2025-10-15T14:00:00",
         "end": "2025-10-15T15:00:00",
         "location": "–û—Ñ–∏—Å",
         "description": "–í–∞–∂–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ"
       }

PUT    /api/events/{user_id}/{event_id}  # –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
DELETE /api/events/{user_id}/{event_id}  # –£–¥–∞–ª–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
GET    /api/health                        # Health check
```

**CORS:**
–†–∞–∑—Ä–µ—à—ë–Ω –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–≤ production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏).

### 3. Radicale CalDAV Server

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
–ï–¥–∏–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ CalDAV.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```
radicale_data/
‚îî‚îÄ‚îÄ collections/
    ‚îî‚îÄ‚îÄ collection-root/
        ‚îú‚îÄ‚îÄ telegram_123456789/          # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 1
        ‚îÇ   ‚îú‚îÄ‚îÄ .Radicale.props
        ‚îÇ   ‚îî‚îÄ‚îÄ event_uid_1.ics
        ‚îú‚îÄ‚îÄ telegram_987654321/          # –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 2
        ‚îÇ   ‚îú‚îÄ‚îÄ .Radicale.props
        ‚îÇ   ‚îî‚îÄ‚îÄ event_uid_2.ics
        ‚îî‚îÄ‚îÄ ...
```

**–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö (iCalendar):**
```ical
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//AI Calendar Assistant//Telegram Bot//RU
BEGIN:VEVENT
UID:a1b2c3d4e5f6...
SUMMARY:–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
DTSTART:20251015T140000
DTEND:20251015T150000
LOCATION:–û—Ñ–∏—Å
DESCRIPTION:–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
END:VEVENT
END:VCALENDAR
```

### 4. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (Telegram Mini App)

**–§–∞–π–ª—ã:**
- `calendar-webapp/index.html` - SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Telegram WebApp API
- Vanilla JavaScript
- Tailwind CSS

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–¥–µ–Ω—å/3 –¥–Ω—è/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü)
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram:**
```javascript
const tg = window.Telegram.WebApp;
const userId = tg.initDataUnsafe?.user?.id;  // –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## –ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è

### ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó: –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**1. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

–ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è –ø–æ **Telegram User ID** (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ):

```python
# –í Telegram Bot
user_id = str(update.effective_user.id)  # –ù–∞–ø—Ä–∏–º–µ—Ä: "123456789"

# –í –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
const userId = tg.initDataUnsafe?.user?.id;  # –¢–æ—Ç –∂–µ ID
```

**2. –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è**

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞—ë—Ç—Å—è **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å**:

```python
# app/services/calendar_radicale.py
def _get_user_calendar_name(self, user_id: str) -> str:
    return f"telegram_{user_id}"  # "telegram_123456789"

def _get_user_calendar(self, user_id: str):
    # –ò—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–ª–∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π
    calendar_name = self._get_user_calendar_name(user_id)

    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–∏
    calendars = principal.calendars()
    for cal in calendars:
        if cal.display_name == calendar_name:
            return cal  # –ù–∞—à–ª–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    new_calendar = principal.make_calendar(name=calendar_name)
    return new_calendar
```

**3. –ò–∑–æ–ª—è—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ Radicale**

Radicale —Å–æ–∑–¥–∞—ë—Ç **–æ—Ç–¥–µ–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```
radicale_data/collections/collection-root/
‚îú‚îÄ‚îÄ telegram_123456789/    ‚Üê –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è A
‚îÇ   ‚îî‚îÄ‚îÄ *.ics
‚îú‚îÄ‚îÄ telegram_987654321/    ‚Üê –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è B
‚îÇ   ‚îî‚îÄ‚îÄ *.ics
‚îî‚îÄ‚îÄ telegram_555555555/    ‚Üê –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è C
    ‚îî‚îÄ‚îÄ *.ics
```

**4. –ò–∑–æ–ª—è—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ API**

API —Ç—Ä–µ–±—É–µ—Ç `user_id` –≤ URL:

```
GET /api/events/123456789  ‚Üê –°–æ–±—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123456789
GET /api/events/987654321  ‚Üê –°–æ–±—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 987654321
```

#### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª—è—Ü–∏–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A —Å–æ–∑–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏–µ**
```
User A (ID: 123) ‚Üí "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 14:00"
    ‚Üì
Bot –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
    ‚Üì
calendar_service.create_event(user_id="123", event_data)
    ‚Üì
Radicale —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ telegram_123/event_xyz.ics
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è**
```
User B (ID: 456) ‚Üí "–ü–æ–∫–∞–∂–∏ –º–æ–∏ —Å–æ–±—ã—Ç–∏—è"
    ‚Üì
Bot –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
    ‚Üì
calendar_service.list_events(user_id="456", ...)
    ‚Üì
Radicale —á–∏—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –∏–∑ telegram_456/
    ‚Üì
User B –ù–ï –í–ò–î–ò–¢ —Å–æ–±—ã—Ç–∏—è User A ‚úÖ
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
```
User A –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–µ–±-–∞–ø–ø
    ‚Üì
Telegram WebApp API: userId = 123
    ‚Üì
fetch(`/api/events/123`)
    ‚Üì
API ‚Üí calendar_service.list_events(user_id="123")
    ‚Üì
Radicale —á–∏—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û telegram_123/
    ‚Üì
User A –≤–∏–¥–∏—Ç –¢–û–õ–¨–ö–û —Å–≤–æ–∏ —Å–æ–±—ã—Ç–∏—è ‚úÖ
```

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

**–£—è–∑–≤–∏–º–æ—Å—Ç—å 1: –ü–æ–¥–¥–µ–ª–∫–∞ user_id –≤ API**

‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –≤—ã–∑–≤–∞—Ç—å:
```bash
curl http://95.163.227.26:8000/api/events/–ß–£–ñ–û–ô_ID
```

‚úÖ **–†–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å):**
```python
# –í API endpoints –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Telegram WebApp signature
from telegram import WebAppInfo
from hashlib import hmac, sha256

def verify_telegram_webapp(init_data: str, bot_token: str) -> bool:
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
    # ...
    pass

@router.get("/events/{user_id}")
async def get_events(
    user_id: str,
    init_data: str = Header(None, alias="X-Telegram-Init-Data")
):
    if not verify_telegram_webapp(init_data, bot_token):
        raise HTTPException(403, "Unauthorized")

    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ user_id —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å ID –≤ init_data
    # ...
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Radicale**

‚úÖ **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
Radicale –Ω–∞—Å—Ç—Ä–æ–µ–Ω –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫:
1. –î–æ—Å—Ç—É–ø –µ—Å—Ç—å –¢–û–õ–¨–ö–û –∏–∑ Docker —Å–µ—Ç–∏ (–Ω–µ –∏–∑–≤–Ω–µ)
2. telegram-bot –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–π
3. –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ calendar_name

‚úÖ **–≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ**, —Ç–∞–∫ –∫–∞–∫:
- –ü–æ—Ä—Ç 5232 –æ—Ç–∫—Ä—ã—Ç, –Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω Docker —Å–µ—Ç—å—é
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∏–∑–≤–Ω–µ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω
- API –±–æ—Ç–∞ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ì–ò–ë–†–ò–î–ù–´–ô –ø–æ–¥—Ö–æ–¥:**

#### 1. Radicale (–§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ) - PRIMARY

**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**
- ‚úÖ –°–æ–±—ã—Ç–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è (iCalendar —Ñ–æ—Ä–º–∞—Ç .ics)
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–π (–≤—Ä–µ–º—è, –º–µ—Å—Ç–æ, –æ–ø–∏—Å–∞–Ω–∏–µ)
- ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü–æ—á–µ–º—É —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:**
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å CalDAV —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–ø—Ä–æ—Å—Ç–æ –∫–æ–ø–∏—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é)
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π –ë–î –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π
- –ú–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Apple/Google Calendar

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
/root/ai-calendar-assistant/radicale_data/
‚îú‚îÄ‚îÄ collections/
‚îÇ   ‚îî‚îÄ‚îÄ collection-root/
‚îÇ       ‚îú‚îÄ‚îÄ telegram_USER_ID_1/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ .Radicale.props         # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ event_uuid_1.ics        # –°–æ–±—ã—Ç–∏–µ 1
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ event_uuid_2.ics        # –°–æ–±—ã—Ç–∏–µ 2
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ       ‚îî‚îÄ‚îÄ telegram_USER_ID_2/
‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ .Radicale.lock
```

**–§–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏—è (.ics):**
```ical
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//AI Calendar Assistant//Telegram Bot//RU
BEGIN:VEVENT
UID:abc123def456                         # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
SUMMARY:–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º              # –ù–∞–∑–≤–∞–Ω–∏–µ
DTSTART:20251015T140000                  # –ù–∞—á–∞–ª–æ
DTEND:20251015T150000                    # –ö–æ–Ω–µ—Ü
DTSTAMP:20251010T120000Z                 # –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
LOCATION:–û—Ñ–∏—Å                            # –ú–µ—Å—Ç–æ
DESCRIPTION:–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞          # –û–ø–∏—Å–∞–Ω–∏–µ
END:VEVENT
END:VCALENDAR
```

#### 2. SQLite (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏)

–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É–∫–∞–∑–∞–Ω `database_url: sqlite:///./calendar_assistant.db`, –Ω–æ:
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–µ–º –¥–ª—è:
  - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
  - –•—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

**Docker Volumes:**
```yaml
# docker-compose.hybrid.yml
services:
  telegram-bot:
    volumes:
      - ./logs:/app/logs                    # –õ–æ–≥–∏
      - ./credentials:/app/credentials      # Credentials

  radicale:
    volumes:
      - ./radicale_data:/data              # ‚Üê –ì–õ–ê–í–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï
      - ./radicale_config:/config          # –ö–æ–Ω—Ñ–∏–≥ Radicale
```

**–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# Backup –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
tar -czf backup_$(date +%Y%m%d).tar.gz \
  /root/ai-calendar-assistant/radicale_data/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
tar -xzf backup_20251010.tar.gz -C /root/ai-calendar-assistant/
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞:**

| –û–ø–µ—Ä–∞—Ü–∏—è | Latency | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ |
|----------|---------|-------------|
| –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è | ~50-100ms | I/O –¥–∏—Å–∫–∞ |
| –ß—Ç–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–º–µ—Å—è—Ü) | ~20-50ms | –†–∞–∑–º–µ—Ä .ics —Ñ–∞–π–ª–∞ |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è | ~50-100ms | I/O –¥–∏—Å–∫–∞ |
| –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è | ~30-60ms | I/O –¥–∏—Å–∫–∞ |

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –î–æ 10,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
- ‚ö†Ô∏è 10,000-50,000 - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è SSD –¥–∏—Å–∫
- ‚ùå 50,000+ - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ PostgreSQL + TimescaleDB

---

## –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ—Ç–æ–∫ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ Telegram Bot

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚îÇ "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 14:00"
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 1. –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram API       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 2. Update object
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TelegramHandler.handle_update() ‚îÇ
‚îÇ - –ò–∑–≤–ª–µ–∫–∞–µ—Ç user_id             ‚îÇ
‚îÇ - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 3. –¢–µ–∫—Å—Ç + user_id
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ LLMAgent.process_message()     ‚îÇ
‚îÇ - Claude API –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç ‚îÇ
‚îÇ - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ:         ‚îÇ
‚îÇ   "create_event"                ‚îÇ
‚îÇ - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ:             ‚îÇ
‚îÇ   {title, date, time}           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 4. EventDTO
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DateTimeParser.parse()           ‚îÇ
‚îÇ - "–∑–∞–≤—Ç—Ä–∞" ‚Üí 2025-10-11          ‚îÇ
‚îÇ - "–≤ 14:00" ‚Üí 14:00:00           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 5. Parsed EventDTO
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ RadicaleService.create_event()     ‚îÇ
‚îÇ - –ü–æ–ª—É—á–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å user_id       ‚îÇ
‚îÇ - –°–æ–∑–¥–∞—ë—Ç iCalendar –æ–±—ä–µ–∫—Ç         ‚îÇ
‚îÇ - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π UID        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 6. CalDAV PUT request
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Radicale CalDAV Server     ‚îÇ
‚îÇ - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç .ics          ‚îÇ
‚îÇ - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∞–π–ª:        ‚îÇ
‚îÇ   telegram_USER_ID/        ‚îÇ
‚îÇ   event_UID.ics            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 7. Success
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Telegram Bot               ‚îÇ
‚îÇ ‚Üí "‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ!"    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚îÇ –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ"
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ     ‚îÇ
‚îÇ  - –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è   ‚îÇ
‚îÇ  - –ù–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä." ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 2. POST /api/events/{user_id}
       ‚îÇ    Body: {title, start, end, ...}
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FastAPI: events.create_event() ‚îÇ
‚îÇ - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç JSON              ‚îÇ
‚îÇ - –°–æ–∑–¥–∞—ë—Ç EventDTO             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 3. EventDTO
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ RadicaleService.create_event()     ‚îÇ
‚îÇ - –ü–æ–ª—É—á–∞–µ—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—å user_id       ‚îÇ
‚îÇ - –°–æ–∑–¥–∞—ë—Ç iCalendar –æ–±—ä–µ–∫—Ç         ‚îÇ
‚îÇ - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π UID        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 4. CalDAV PUT request
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Radicale CalDAV Server     ‚îÇ
‚îÇ - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç event_UID.ics  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 5. Success + event_uid
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FastAPI Response           ‚îÇ
‚îÇ ‚Üí 200 OK {id, title, ...}  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ 6. JSON response
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ             ‚îÇ
‚îÇ - –î–æ–±–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ UI   ‚îÇ
‚îÇ - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–±–æ—Ç ‚Üî –≤–µ–±-–∞–ø–ø)

**–í–∞–∂–Ω–æ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —á–µ—Ä–µ–∑ Radicale:

```
–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–ª —Å–æ–±—ã—Ç–∏–µ –≤ –±–æ—Ç–µ,
          –∑–∞—Ç–µ–º –æ—Ç–∫—Ä—ã–ª –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

1. [–ë–û–¢] –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
   User ‚Üí Bot ‚Üí Radicale.save(event_A.ics)

2. [–í–ï–ë] –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π (—á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É)
   WebApp ‚Üí GET /api/events/USER_ID
          ‚Üí RadicaleService.list_events()
          ‚Üí Radicale.read(telegram_USER_ID/*.ics)
          ‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç [event_A, ...]

3. –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –°–æ–±—ã—Ç–∏–µ –∏–∑ –±–æ—Ç–∞ –≤–∏–¥–Ω–æ –≤ –≤–µ–±-–∞–ø–ø!

–û–±—Ä–∞—Ç–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ:
1. [–í–ï–ë] –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
   WebApp ‚Üí POST /api/events ‚Üí Radicale.save(event_B.ics)

2. [–ë–û–¢] –ó–∞–ø—Ä–æ—Å —Å–ø–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π
   User ‚Üí "–ü–æ–∫–∞–∂–∏ –º–æ–∏ —Å–æ–±—ã—Ç–∏—è"
       ‚Üí RadicaleService.list_events()
       ‚Üí Radicale.read() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç [event_A, event_B]

3. –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –°–æ–±—ã—Ç–∏–µ –∏–∑ –≤–µ–±-–∞–ø–ø –≤–∏–¥–Ω–æ –≤ –±–æ—Ç–µ!
```

**–ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø:** Radicale - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã (Single Source of Truth)

---

## Use Cases

### Use Case 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç—É

**–ê–∫—Ç—ë—Ä—ã:** –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–Ω–∞–µ—Ç –∏–º—è –±–æ—Ç–∞
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–∑–¥–∞–Ω

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –±–æ—Ç–∞ –≤ Telegram –ø–æ –∏–º–µ–Ω–∏
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "Start"
3. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
   ```
   üëã –ü—Ä–∏–≤–µ—Ç! –Ø AI Calendar Assistant.

   –Ø –ø–æ–º–æ–≥—É —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞—à–∏–º –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º —á–µ—Ä–µ–∑ –≥–æ–ª–æ—Å–æ–≤—ã–µ
   —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ.

   –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
   - "–í—Å—Ç—Ä–µ—á–∞ –∑–∞–≤—Ç—Ä–∞ –≤ 14:00"
   - "–ü–æ–∫–∞–∂–∏ –º–æ–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –Ω–µ–¥–µ–ª—é"
   - "–ù–∞–π–¥–∏ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—è—Ç–Ω–∏—Ü—É"
   ```
4. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç `user_id` –∏–∑ `update.effective_user.id`
   - –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è daily reminders
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞—ë—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å `telegram_{user_id}`
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
- **1a.** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±–æ—Ç–∞ ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è
- **3a.** –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ"

---

### Use Case 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≥–æ–ª–æ—Å–æ–º

**–ê–∫—Ç—ë—Ä—ã:** –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:
   _"–í—Å—Ç—Ä–µ—á–∞ —Å –ê–ª–µ–∫—Å–µ–µ–º –∑–∞–≤—Ç—Ä–∞ –≤ –¥–≤–∞ —á–∞—Å–∞ –¥–Ω—è –≤ –æ—Ñ–∏—Å–µ –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π"_
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
3. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ø–µ—á–∞—Ç–∞–µ—Ç..."
4. **–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
   - –°–∫–∞—á–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ—Ñ–∞–π–ª —á–µ—Ä–µ–∑ Telegram API
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Whisper (—á–µ—Ä–µ–∑ ffmpeg)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ OpenAI Whisper API
   - –ü–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—Å—Ç: _"–í—Å—Ç—Ä–µ—á–∞ —Å –ê–ª–µ–∫—Å–µ–µ–º –∑–∞–≤—Ç—Ä–∞ –≤ –¥–≤–∞ —á–∞—Å–∞ –¥–Ω—è..."_
5. **–°–∏—Å—Ç–µ–º–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:**
   - Claude API –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ: `create_event`
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç:
     - –ù–∞–∑–≤–∞–Ω–∏–µ: "–í—Å—Ç—Ä–µ—á–∞ —Å –ê–ª–µ–∫—Å–µ–µ–º"
     - –î–∞—Ç–∞: "–∑–∞–≤—Ç—Ä–∞" ‚Üí 2025-10-11
     - –í—Ä–µ–º—è: "–¥–≤–∞ —á–∞—Å–∞ –¥–Ω—è" ‚Üí 14:00
     - –ú–µ—Å—Ç–æ: "–æ—Ñ–∏—Å –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π"
6. **–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏–µ:**
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π UID
   - –°–æ–∑–¥–∞—ë—Ç iCalendar –æ–±—ä–µ–∫—Ç
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Radicale: `telegram_USER_ID/event_UID.ics`
7. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
   ```
   ‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ!

   üìÖ –í—Å—Ç—Ä–µ—á–∞ —Å –ê–ª–µ–∫—Å–µ–µ–º
   üïê 11 –æ–∫—Ç—è–±—Ä—è 2025, 14:00
   üìç –æ—Ñ–∏—Å –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π
   ```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
- **4a.** Whisper API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí "–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≥–æ–ª–æ—Å"
- **5a.** Claude –Ω–µ —Å–º–æ–≥ –∏–∑–≤–ª–µ—á—å –¥–∞—Ç—É ‚Üí –ü—Ä–æ—Å–∏—Ç —É—Ç–æ—á–Ω–∏—Ç—å
- **6a.** –ö–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí "–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ"

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫:**
```python
# 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ
file = await context.bot.get_file(voice.file_id)
await file.download_to_drive("voice.ogg")

# 2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ ffmpeg
subprocess.run(["ffmpeg", "-i", "voice.ogg", "voice.mp3"])

# 3. –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è
with open("voice.mp3", "rb") as audio:
    transcript = openai.Audio.transcribe("whisper-1", audio)
    text = transcript.text

# 4. NLU —á–µ—Ä–µ–∑ Claude
intent, entities = llm_agent.process_message(text, user_id)

# 5. –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
start_dt = datetime_parser.parse(entities["date"], entities["time"])

# 6. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
event_uid = await calendar_service.create_event(
    user_id=user_id,
    event=EventDTO(
        title=entities["title"],
        start_time=start_dt,
        location=entities.get("location")
    )
)
```

---

### Use Case 3: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—ã—Ç–∏–π –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

**–ê–∫—Ç—ë—Ä—ã:** –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–≤–æ–∏ —Å–æ–±—ã—Ç–∏—è

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Telegram Mini App (–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
2. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - Telegram WebApp API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `initData` —Å `user_id`
   - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç `user_id`
3. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
   ```javascript
   const tg = window.Telegram.WebApp;
   const userId = tg.initDataUnsafe?.user?.id;  // "123456789"
   ```
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è:
   ```javascript
   const response = await fetch(
     `http://95.163.227.26:8000/api/events/${userId}?` +
     `start=${startDate}&end=${endDate}`
   );
   const events = await response.json();
   ```
5. **API –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å:**
   - –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ Radicale
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON –º–∞—Å—Å–∏–≤ —Å–æ–±—ã—Ç–∏–π
6. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ:
   - –ú–µ—Å—è—á–Ω—ã–π –≤–∏–¥ —Å –º–µ—Ç–∫–∞–º–∏ —Å–æ–±—ã—Ç–∏–π
   - –î–Ω–µ–≤–Ω–æ–π –≤–∏–¥ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å–ª–æ—Ç–∞–º–∏
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
- **2a.** `user_id` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "–û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram"
- **4a.** API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è"
- **5a.** –ù–µ—Ç —Å–æ–±—ã—Ç–∏–π ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å "–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π"

---

### Use Case 4: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ê–∫—Ç—ë—Ä—ã:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –°–æ–±—ã—Ç–∏–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —Å–æ–±—ã—Ç–∏–µ
3. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏:
   ```
   –ù–∞–∑–≤–∞–Ω–∏–µ: –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
   –î–∞—Ç–∞: 15.10.2025
   –í—Ä–µ–º—è: 14:00 - 15:00
   –ú–µ—Å—Ç–æ: –û—Ñ–∏—Å

   [–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å] [–£–¥–∞–ª–∏—Ç—å]
   ```
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"
5. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –≤—Ä–µ–º—è: 14:00 ‚Üí 15:00
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
8. **–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ:**
   ```javascript
   await fetch(
     `http://95.163.227.26:8000/api/events/${userId}/${eventId}`,
     {
       method: 'PUT',
       body: JSON.stringify({
         title: "–í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º",
         start: "2025-10-15T15:00:00",
         end: "2025-10-15T16:00:00",
         location: "–û—Ñ–∏—Å"
       })
     }
   );
   ```
9. **API –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤ Radicale:**
   - –ù–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª `event_UID.ics`
   - –ß–∏—Ç–∞–µ—Ç iCalendar –æ–±—ä–µ–∫—Ç
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è DTSTART, DTEND
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ
10. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "‚úÖ –°–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ"
11. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**
- **8a.** –°–æ–±—ã—Ç–∏–µ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ ‚Üí "–°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
- **9a.** Radicale –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí "–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"

---

### Use Case 5: –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏

**–ê–∫—Ç—ë—Ä—ã:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Å–æ–±—ã—Ç–∏—è
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –ù–∞–π–¥–µ–Ω—ã —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –±–æ—Ç—É:
   _"–ù–∞–π–¥–∏ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—è—Ç–Ω–∏—Ü—É"_
2. **–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
   - Claude –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ: `find_free_slots`
   - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞—Ç—É: "–ø—è—Ç–Ω–∏—Ü–∞" ‚Üí 2025-10-11
3. **–°–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã:**
   ```python
   free_slots = await calendar_service.find_free_slots(
       user_id=user_id,
       date=datetime(2025, 10, 11),
       work_hours_start=9,
       work_hours_end=18,
       slot_duration=60
   )
   ```
4. **–ê–ª–≥–æ—Ä–∏—Ç–º:**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
   - –°–æ–∑–¥–∞—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é —à–∫–∞–ª—É 9:00-18:00
   - –í—ã—á–∏—Ç–∞–µ—Ç –∑–∞–Ω—è—Ç—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –ø–æ 60 –º–∏–Ω—É—Ç
5. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
   ```
   üóì –°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—è—Ç–Ω–∏—Ü—É, 11 –æ–∫—Ç—è–±—Ä—è:

   ‚úÖ 09:00 - 10:00
   ‚úÖ 11:30 - 12:30
   ‚úÖ 15:00 - 16:00
   ‚úÖ 16:00 - 17:00

   –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –¥–ª—è –≤—Å—Ç—Ä–µ—á–∏
   ```

---

### Use Case 6: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

**–ê–∫—Ç—ë—Ä—ã:** –°–∏—Å—Ç–µ–º–∞, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
**–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
**–ü–æ—Å—Ç—É—Å–ª–æ–≤–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**

1. **–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç scheduler:**
   ```python
   # –í run_hybrid.py
   reminders_task = asyncio.create_task(
       reminders.run_daily_schedule()
   )
   ```
2. **–£—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (9:00):**
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
   - –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è:
     ```
     üåÖ –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!

     üìÖ –í–∞—à–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è:

     ‚Ä¢ 14:00 - –í—Å—Ç—Ä–µ—á–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º
     ‚Ä¢ 16:00 - –ó–≤–æ–Ω–æ–∫ –∫–æ–º–∞–Ω–¥–µ

     –•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è!
     ```
   - –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ–±—ã—Ç–∏–π:
     ```
     üåÖ –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!

     –£ –≤–∞—Å –Ω–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.
     ```
3. **–í–µ—á–µ—Ä–Ω–µ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ (20:00):**
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –Ω–∞ –∑–∞–≤—Ç—Ä–∞
   - –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è:
     ```
     üåô –î–æ–±—Ä—ã–π –≤–µ—á–µ—Ä!

     üìÖ –ó–∞–≤—Ç—Ä–∞ —É –≤–∞—Å:

     ‚Ä¢ 10:00 - –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–∏–Ω—Ç–∞
     ‚Ä¢ 15:00 - –í—Å—Ç—Ä–µ—á–∞ —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º

     –°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏!
     ```

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫:**
```python
class DailyRemindersService:
    async def run_daily_schedule(self):
        while self.running:
            now = datetime.now(self.timezone)

            # –£—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ 9:00
            if now.hour == 9 and now.minute == 0:
                await self.send_morning_reminders()

            # –í–µ—á–µ—Ä–Ω–µ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ 20:00
            if now.hour == 20 and now.minute == 0:
                await self.send_evening_reminders()

            await asyncio.sleep(60)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

    async def send_morning_reminders(self):
        for user_id, chat_id in self.registered_users.items():
            today = datetime.now().replace(hour=0, minute=0)
            tomorrow = today + timedelta(days=1)

            events = await calendar_service.list_events(
                user_id, today, tomorrow
            )

            message = self.format_daily_events(events, "today")
            await self.bot.send_message(chat_id, message)
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
   - –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ user_id
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —á—É–∂–∏–º –¥–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ API

2. **Docker Network Isolation**
   - Radicale –¥–æ—Å—Ç—É–ø–µ–Ω –¢–û–õ–¨–ö–û –∏–∑ Docker —Å–µ—Ç–∏
   - –í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç—É 5232 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
   - telegram-bot - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç —Å –¥–æ—Å—Ç—É–ø–æ–º

3. **HTTPS/SSL (–ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DNS)**
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (structlog)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:**

**1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Telegram WebApp Signature**

```python
# app/routers/events.py
from hashlib import hmac, sha256
from fastapi import Header, HTTPException

def verify_telegram_webapp_data(init_data: str, bot_token: str) -> dict:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram WebApp.

    –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://core.telegram.org/bots/webapps#validating-data-received-via-the-mini-app
    """
    try:
        # –ü–∞—Ä—Å–∏–Ω–≥ init_data
        params = dict(x.split('=') for x in init_data.split('&'))
        data_check_string = '\n'.join(
            f"{k}={v}" for k, v in sorted(params.items()) if k != 'hash'
        )

        # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö—ç—à–∞
        secret_key = hmac.new(
            b"WebAppData",
            bot_token.encode(),
            sha256
        ).digest()

        data_hash = hmac.new(
            secret_key,
            data_check_string.encode(),
            sha256
        ).hexdigest()

        # –ü—Ä–æ–≤–µ—Ä–∫–∞
        if data_hash != params.get('hash'):
            raise ValueError("Invalid hash")

        return params
    except Exception as e:
        raise HTTPException(403, f"Unauthorized: {str(e)}")

@router.get("/events/{user_id}")
async def get_events(
    user_id: str,
    x_telegram_init_data: str = Header(None, alias="X-Telegram-Init-Data")
):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
    init_data = verify_telegram_webapp_data(
        x_telegram_init_data,
        settings.telegram_bot_token
    )

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ user_id —Å–æ–≤–ø–∞–¥–∞–µ—Ç
    if str(init_data.get('user', {}).get('id')) != user_id:
        raise HTTPException(403, "User ID mismatch")

    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
```

**2. Rate Limiting**

```python
from slowapi import Limiter, _rate_limit_exceeded_handler
from slowapi.util import get_remote_address

limiter = Limiter(key_func=get_remote_address)
app.state.limiter = limiter
app.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)

@router.post("/events/{user_id}")
@limiter.limit("10/minute")  # –ú–∞–∫—Å–∏–º—É–º 10 —Å–æ–±—ã—Ç–∏–π –≤ –º–∏–Ω—É—Ç—É
async def create_event(request: Request, user_id: str, ...):
    ...
```

**3. Input Validation**

```python
from pydantic import BaseModel, validator, Field

class EventCreateRequest(BaseModel):
    title: str = Field(..., min_length=1, max_length=200)
    start: datetime
    end: datetime
    location: str = Field(default="", max_length=500)
    description: str = Field(default="", max_length=5000)

    @validator('end')
    def end_after_start(cls, v, values):
        if 'start' in values and v <= values['start']:
            raise ValueError('end must be after start')
        return v

    @validator('start', 'end')
    def not_in_past(cls, v):
        if v < datetime.now(timezone.utc):
            raise ValueError('cannot create events in the past')
        return v
```

---

## –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –£–∑–∫–æ–µ –º–µ—Å—Ç–æ |
|-----------|-------------|-------------|
| **Radicale** | ~10K –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | I/O –¥–∏—Å–∫–∞ |
| **FastAPI** | ~1000 req/sec | CPU |
| **Telegram Bot** | ~30 msg/sec | Telegram API limit |
| **–î–∏—Å–∫** | 10GB (REG.RU VPS) | –†–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞ |
| **RAM** | 2GB | –ü–∞–º—è—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ |

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

#### –§–∞–∑–∞ 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–¥–æ 10K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

‚úÖ **–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã/–∫—ç—à –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –ë–î
- –õ–æ–≥—Ä–æ—Ç–∞—Ü–∏—è (—Ç–µ–∫—É—â–∏–µ –ª–æ–≥–∏ –º–æ–≥—É—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∏—Å–∫)

```bash
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤
cat > /etc/logrotate.d/calendar-bot << EOF
/root/ai-calendar-assistant/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
}
EOF
```

#### –§–∞–∑–∞ 2: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (10K-50K –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ê–ø–≥—Ä–µ–π–¥ —Å–µ—Ä–≤–µ—Ä–∞:**
- CPU: 2 ‚Üí 4 cores
- RAM: 2GB ‚Üí 8GB
- –î–∏—Å–∫: HDD ‚Üí SSD 50GB

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
```yaml
# docker-compose.hybrid.yml
services:
  telegram-bot:
    deploy:
      resources:
        limits:
          cpus: '2.0'
          memory: 4G
        reservations:
          cpus: '1.0'
          memory: 2G

  radicale:
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 2G
```

**–î–æ–±–∞–≤–∏—Ç—å Redis –∫—ç—à:**
```python
import redis

redis_client = redis.Redis(host='localhost', port=6379)

async def get_user_events_cached(user_id: str, start: datetime, end: datetime):
    cache_key = f"events:{user_id}:{start}:{end}"

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
    cached = redis_client.get(cache_key)
    if cached:
        return json.loads(cached)

    # –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ Radicale
    events = await calendar_service.list_events(user_id, start, end)

    # –ö—ç—à–∏—Ä—É–µ–º –Ω–∞ 5 –º–∏–Ω—É—Ç
    redis_client.setex(cache_key, 300, json.dumps(events))

    return events
```

#### –§–∞–∑–∞ 3: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (50K+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
                    Load Balancer (Nginx)
                            |
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                   ‚îÇ                   ‚îÇ
   Bot Server 1        Bot Server 2       Bot Server 3
        ‚îÇ                   ‚îÇ                   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                   PostgreSQL Cluster
                   (TimescaleDB –¥–ª—è —Å–æ–±—ã—Ç–∏–π)
```

**–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL:**
```sql
-- –°—Ö–µ–º–∞ –ë–î
CREATE TABLE users (
    telegram_user_id BIGINT PRIMARY KEY,
    timezone VARCHAR(50) DEFAULT 'Europe/Moscow',
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE events (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id BIGINT REFERENCES users(telegram_user_id),
    title VARCHAR(200) NOT NULL,
    start_time TIMESTAMPTZ NOT NULL,
    end_time TIMESTAMPTZ NOT NULL,
    location VARCHAR(500),
    description TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX idx_events_user_time ON events(user_id, start_time);
CREATE INDEX idx_events_start ON events(start_time);
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ (structlog):**
```python
logger.info(
    "event_created",
    user_id=user_id,
    event_uid=uid,
    title=event.title,
    timestamp=datetime.now().isoformat()
)
```

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–æ–≤:**
```
/root/ai-calendar-assistant/logs/
‚îú‚îÄ‚îÄ app.log              # –û—Å–Ω–æ–≤–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ telegram_bot.log     # –õ–æ–≥–∏ Telegram –±–æ—Ç–∞
‚îî‚îÄ‚îÄ api.log              # –õ–æ–≥–∏ FastAPI
```

**Docker –ª–æ–≥–∏:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs telegram-bot -f --tail 100
docker logs radicale -f --tail 100

# –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
docker logs telegram-bot > bot_logs_$(date +%Y%m%d).log
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É

**1. Health Checks**

–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
```bash
curl http://95.163.227.26:8000/health
curl http://95.163.227.26:8000/api/health
```

**2. –ú–µ—Ç—Ä–∏–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å)**

```python
# –î–æ–±–∞–≤–∏—Ç—å Prometheus metrics
from prometheus_client import Counter, Histogram, start_http_server

# –ú–µ—Ç—Ä–∏–∫–∏
events_created = Counter('events_created_total', 'Total events created')
api_request_duration = Histogram('api_request_duration_seconds', 'API request duration')

@router.post("/events/{user_id}")
async def create_event(...):
    with api_request_duration.time():
        # ... –ª–æ–≥–∏–∫–∞
        events_created.inc()
```

**3. Alerting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–∞
- Uptime monitoring (uptimerobot.com)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ú—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É Telegram –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- ‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ REST API –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º
- ‚úÖ NLU –Ω–∞ –±–∞–∑–µ Claude API
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
- ‚úÖ CalDAV —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ REG.RU VPS

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Radicale) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- –ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å CalDAV –∫–ª–∏–µ–Ω—Ç–∞–º–∏

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Telegram WebApp signature
- ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSL (–ø–æ—Å–ª–µ DNS)
- ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å rate limiting

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
**–î–∞—Ç–∞:** 10 –æ–∫—Ç—è–±—Ä—è 2025
**–ê–≤—Ç–æ—Ä:** AI Calendar Assistant Team
