# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Yandex GPT

## –ü—Ä–æ–±–ª–µ–º–∞

Claude –∏ OpenAI –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –≤ –†–æ—Å—Å–∏–∏ –ø–æ IP. –ë–æ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ REG.RU (91.229.8.221, –ú–æ—Å–∫–≤–∞) –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –∏—Ö API.

## –†–µ—à–µ–Ω–∏–µ: Yandex GPT

Yandex GPT - —ç—Ç–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏–π –∞–Ω–∞–ª–æ–≥ ChatGPT/Claude, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ VPN –∏–∑ –†–æ—Å—Å–∏–∏.

---

## –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π Yandex Cloud

### 1.1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ Yandex Cloud

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ https://console.cloud.yandex.ru/
2. –í–æ–π–¥–∏ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å ID (–∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è)
3. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π **Billing Account** (–Ω—É–∂–Ω–∞ –∫–∞—Ä—Ç–∞, –Ω–æ –µ—Å—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç—Ä–∏–∞–ª)
4. –°–æ–∑–¥–∞–π **Folder** (–∫–∞—Ç–∞–ª–æ–≥) - –Ω–∞–ø—Ä–∏–º–µ—Ä, "ai-calendar-bot"

### 1.2. –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. –í –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud –≤—ã–±–µ—Ä–∏ —Å–≤–æ–π folder
2. –ü–µ—Ä–µ–π–¥–∏ –≤ **"Service Accounts"** (–°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã)
3. –ù–∞–∂–º–∏ **"Create service account"**
4. –ó–∞–¥–∞–π –∏–º—è: `ai-calendar-service`
5. –î–æ–±–∞–≤—å —Ä–æ–ª—å: **`ai.languageModels.user`** (–¥–æ—Å—Ç—É–ø –∫ Yandex GPT)
6. –ù–∞–∂–º–∏ **"Create"**

### 1.3. –°–æ–∑–¥–∞–Ω–∏–µ API Key

1. –û—Ç–∫—Ä–æ–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account
2. –ü–µ—Ä–µ–π–¥–∏ –≤–æ –≤–∫–ª–∞–¥–∫—É **"API Keys"**
3. –ù–∞–∂–º–∏ **"Create API Key"**
4. **–í–ê–ñ–ù–û:** –°–∫–æ–ø–∏—Ä—É–π –∫–ª—é—á –∏ —Å–æ—Ö—Ä–∞–Ω–∏ - –æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!
5. –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: `AQVN...` (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å AQ)

### 1.4. –ü–æ–ª—É—á–µ–Ω–∏–µ Folder ID

1. –í –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud –æ—Ç–∫—Ä–æ–π —Å–≤–æ–π folder
2. –°–∫–æ–ø–∏—Ä—É–π **Folder ID** (—Ñ–æ—Ä–º–∞—Ç: `b1g...` –∏–ª–∏ `aoe...`)
3. –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—É –≤ CLI:
   ```bash
   yc config list
   ```

---

## –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É:

```bash
ssh root@91.229.8.221
```

–ü–∞—Ä–æ–ª—å: `YOUR_SSH_PASSWORD`

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env`:

```bash
cd /root/ai-calendar-assistant
nano .env
```

–î–æ–±–∞–≤—å —Å—Ç—Ä–æ–∫–∏ (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è):

```
# Yandex GPT (—Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –†–æ—Å—Å–∏–∏ –±–µ–∑ VPN)
YANDEX_GPT_API_KEY=AQVNxxxxxxxxxxxxxxxxxxxxxxxxx
YANDEX_GPT_FOLDER_ID=b1gxxxxxxxxxxxxxxxxxx
```

–°–æ—Ö—Ä–∞–Ω–∏ (Ctrl+O, Enter, Ctrl+X).

---

## –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /root/ai-calendar-assistant
git pull origin main
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

–ï—Å–ª–∏ Git –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Å–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é:

#### 3.1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª llm_agent_yandex.py

```bash
nano /root/ai-calendar-assistant/app/services/llm_agent_yandex.py
```

–°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞:
`/Users/fatbookpro/ai-calendar-assistant/app/services/llm_agent_yandex.py`

#### 3.2. –û–±–Ω–æ–≤–∏ config.py

```bash
nano /root/ai-calendar-assistant/app/config.py
```

–î–æ–±–∞–≤—å –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 40 (–ø–æ—Å–ª–µ OpenAI):

```python
    # Yandex GPT (for regions where Claude/OpenAI are blocked)
    yandex_gpt_api_key: Optional[str] = None
    yandex_gpt_folder_id: Optional[str] = None
```

#### 3.3. –û–±–Ω–æ–≤–∏ telegram_handler.py

```bash
nano /root/ai-calendar-assistant/app/services/telegram_handler.py
```

–ù–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É 9:
```python
from app.services.llm_agent_openai import llm_agent_openai as llm_agent
```

–ó–∞–º–µ–Ω–∏ –Ω–∞:
```python
from app.services.llm_agent_yandex import llm_agent_yandex as llm_agent
```

#### 3.4. –û–±–Ω–æ–≤–∏ requirements.txt

```bash
nano /root/ai-calendar-assistant/requirements.txt
```

–î–æ–±–∞–≤—å –≤ —Å–µ–∫—Ü–∏—é `# HTTP Client`:
```
requests>=2.31.0
```

---

## –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º

```bash
cd /root/ai-calendar-assistant

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose -f docker-compose.production.yml down

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å –Ω–æ–≤—ã–º –∫–æ–¥–æ–º
docker-compose -f docker-compose.production.yml up -d --build

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker logs -f telegram-bot
```

---

## –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–û—Ç–ø—Ä–∞–≤—å –±–æ—Ç—É —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
–í—Å—Ç—Ä–µ—á–∞ —Å –ü–µ—Ç—Ä–æ–≤—ã–º –∑–∞–≤—Ç—Ä–∞ –≤ 14:00
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
‚úÖ –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ!

üìÖ –í—Å—Ç—Ä–µ—á–∞ —Å –ü–µ—Ç—Ä–æ–≤—ã–º
üïê –ó–∞–≤—Ç—Ä–∞ –≤ 14:00
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ –±–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:

```bash
docker logs telegram-bot --tail 100
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:

#### 1. "yandex_gpt_api_key not found"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ `.env` –¥–æ–±–∞–≤–ª–µ–Ω—ã `YANDEX_GPT_API_KEY` –∏ `YANDEX_GPT_FOLDER_ID`.

#### 2. "401 Unauthorized"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ Service Account –∏–º–µ–µ—Ç —Ä–æ–ª—å `ai.languageModels.user`

#### 3. "403 Forbidden"

**–ü—Ä–∏—á–∏–Ω–∞:** Folder ID –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ —É Service Account –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞.

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å Folder ID –≤ –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ Service Account —Å–æ–∑–¥–∞–Ω –≤ —Ç–æ–º –∂–µ folder

#### 4. "Module not found: llm_agent_yandex"

**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
```bash
ls -la /root/ai-calendar-assistant/app/services/llm_agent_yandex.py
```

#### 5. "–Ø –Ω–µ –º–æ–≥—É –æ–±—Å—É–∂–¥–∞—Ç—å —ç—Ç—É —Ç–µ–º—É" (Content Moderation)

**–ü—Ä–∏—á–∏–Ω–∞:** Yandex GPT –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –º–æ–¥–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞. –ï—Å–ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –º–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏–π —Å "—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏" –¥–∞–Ω–Ω—ã–º–∏ (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ: –£–ó–ò, –ú–†–¢, –≤—Ä–∞—á–∏; —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏ —Ç.–¥.), GPT –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç–≤–µ—á–∞—Ç—å.

**–†–µ—à–µ–Ω–∏–µ:** –í –∫–æ–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏–º–∏—Ç **10 —Å–æ–±—ã—Ç–∏–π** –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ:
- `app/services/llm_agent_yandex.py:582` - `max_events_in_context = 10` –¥–ª—è events_prefix
- `app/services/llm_agent_yandex.py:699` - `max_events_in_context = 10` –¥–ª—è event_id_enum

**–í–ê–ñ–ù–û:** –ù–µ —É–¥–∞–ª—è–π —ç—Ç–æ—Ç –ª–∏–º–∏—Ç! –ë–µ–∑ –Ω–µ–≥–æ –±–æ—Ç –±—É–¥–µ—Ç –ª–æ–º–∞—Ç—å—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–±—ã—Ç–∏–π.

---

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Yandex GPT

‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –†–æ—Å—Å–∏–∏ –±–µ–∑ VPN
‚úÖ –î–µ—à–µ–≤–ª–µ, —á–µ–º Claude/OpenAI (–¥–ª—è –†–§)
‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –Ω–∞ –Ω–∞—Ç–∏–≤–Ω–æ–º —É—Ä–æ–≤–Ω–µ
‚úÖ –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç (latency ~1-2 —Å–µ–∫)
‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –Ω–∞—à–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π (existing_events, update/delete)

---

## –°—Ç–æ–∏–º–æ—Å—Ç—å

**Yandex GPT:** ~0.5‚ÇΩ –∑–∞ 1000 —Ç–æ–∫–µ–Ω–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 10 —Ä–∞–∑ –¥–µ—à–µ–≤–ª–µ Claude)

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç—Ä–∏–∞–ª:** 1000‚ÇΩ –Ω–∞ —Å—á–µ—Ç—É –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–°—Ä–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å:** ~500 —Ç–æ–∫–µ–Ω–æ–≤ = 0.25‚ÇΩ

**20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å:** ~5‚ÇΩ = 150‚ÇΩ/–º–µ—Å—è—Ü

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–µ—Å–ª–∏ –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç Yandex)

1. **GigaChat** (–°–±–µ—Ä) - –∞–Ω–∞–ª–æ–≥ –æ—Ç –°–±–µ—Ä–∞
2. **YandexGPT Lite** - –±–æ–ª–µ–µ –¥–µ—à–µ–≤–∞—è –≤–µ—Ä—Å–∏—è
3. **–õ–æ–∫–∞–ª—å–Ω–∞—è LLM** (Ollama) - —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ RAM (–º–∏–Ω–∏–º—É–º 2GB)
4. **VPN –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è Claude/OpenAI

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Yandex Cloud Console](https://console.cloud.yandex.ru/)
- [Yandex GPT Docs](https://cloud.yandex.ru/docs/yandexgpt/)
- [Pricing](https://cloud.yandex.ru/docs/yandexgpt/pricing)
- [API Reference](https://cloud.yandex.ru/docs/yandexgpt/api-ref/)

---

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã - –ø–∏—à–∏, —Ä–∞–∑–±–µ—Ä–µ–º—Å—è! üöÄ
