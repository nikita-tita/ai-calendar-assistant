# üè† Property Search Bot - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

## –û–±–∑–æ—Ä

–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±–æ—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç—Ä–æ–µ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –±–æ—Ç–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ "–ö–∞–ª–µ–Ω–¥–∞—Ä—å" –∏ "–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏".

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (`app/models/property.py`)
   - `PropertyClient` - –ø—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏
   - `PropertyListing` - –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
   - `PropertySelection` - –ø–æ–¥–±–æ—Ä–∫–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
   - `SelectionItem` - —ç–ª–µ–º–µ–Ω—Ç –ø–æ–¥–±–æ—Ä–∫–∏ —Å –æ—Ü–µ–Ω–∫–æ–π
   - `SelectionFeedback` - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (–ª–∞–π–∫–∏/–¥–∏–∑–ª–∞–π–∫–∏)
   - `UserBotMode` - —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **Pydantic —Å—Ö–µ–º—ã** (`app/schemas/property.py`)
   - –°—Ö–µ–º—ã —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

3. **–°–µ—Ä–≤–∏—Å—ã**
   - `property_service.py` - —Ä–∞–±–æ—Ç–∞ —Å –ë–î
   - `property_scoring.py` - —Å–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
   - `property_handler.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∂–∏–º–µ –ø–æ–∏—Å–∫–∞

4. **API Router** (`app/routers/property.py`)
   - REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å—é
   - –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤, –ª–∏—Å—Ç–∏–Ω–≥–æ–≤, –ø–æ–¥–±–æ—Ä–æ–∫, —Ñ–∏–¥–±–µ–∫–∞

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

–í –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–º –±–æ—Ç–µ –ø–æ—è–≤–∏–ª–∞—Å—å –∫–Ω–æ–ø–∫–∞ **"üè† –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏"**:

```
üìã –î–µ–ª–∞ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
üìÖ –î–µ–ª–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞  üìÜ –î–µ–ª–∞ –Ω–∞ –Ω–µ–¥–µ–ª—é
üè† –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏  ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
```

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏:
1. –†–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ `BotMode.PROPERTY`
2. –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞:
   ```
   üîç –ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫
   üìä –ú–æ–∏ –ø–æ–¥–±–æ—Ä–∫–∏
   üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å  ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
   ```

### –ü–æ–∏—Å–∫ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏

#### –£–ø—Ä–∞–≤–ª—è–µ–º—ã–π –ø–æ–∏—Å–∫ (Step-by-step)

1. **–ë—é–¥–∂–µ—Ç**: "–æ—Ç 8 –¥–æ 12 –º–∏–ª–ª–∏–æ–Ω–æ–≤"
2. **–ö–æ–º–Ω–∞—Ç—ã**: "2-3 –∫–æ–º–Ω–∞—Ç–Ω–∞—è"
3. **–õ–æ–∫–∞—Ü–∏—è**: "–ë—É—Ç–æ–≤–æ" –∏–ª–∏ "—Ä—è–¥–æ–º —Å –º–µ—Ç—Ä–æ –¢–µ–ø–ª—ã–π –°—Ç–∞–Ω"
4. **–î–æ–ø. —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**: "–Ω–µ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–∂, —Å –ª–∏—Ñ—Ç–æ–º"
5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –ø–æ–∫–∞–∑ —Å–≤–æ–¥–∫–∏ –∏ –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

#### –°–≤–æ–±–æ–¥–Ω–∞—è —Ñ–æ—Ä–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —Å—Ä–∞–∑—É:
> "–ò—â—É 2-–∫–æ–º–Ω–∞—Ç–Ω—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É –≤ –ë—É—Ç–æ–≤–æ –¥–æ 10 –º–∏–ª–ª–∏–æ–Ω–æ–≤, –Ω–µ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–∂"

(–¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Yandex GPT –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

### –°–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞

**Dream Score (0-100)** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|-----|----------|
| Location | 35% | –ë–ª–∏–∑–æ—Å—Ç—å –∫ –≤–∞–∂–Ω—ã–º —Ç–æ—á–∫–∞–º (—Ä–∞–±–æ—Ç–∞, —Å–∞–¥) |
| Transport | 15% | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–æ/—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ |
| Light | 10% | –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Å–≤–µ—â–µ–Ω–∏–µ |
| View | 5% | –ö–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–∞ (–ø–∞—Ä–∫, –¥–≤–æ—Ä, —É–ª–∏—Ü–∞) |
| Plan | 10% | –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ –∏ —É–¥–æ–±—Å—Ç–≤–∞ |
| Noise | 5% | –£—Ä–æ–≤–µ–Ω—å —à—É–º–∞ |
| Infra | 10% | –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–º–∞–≥–∞–∑–∏–Ω—ã, —à–∫–æ–ª—ã, –ø–∞—Ä–∫–∏) |
| Price | 20% | –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/—Ä—ã–Ω–æ–∫ |
| Building | 5% | –ö–∞—á–µ—Å—Ç–≤–æ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞ |

### –û–±—ä—è—Å–Ω–µ–Ω–∏—è

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:

```json
{
  "why_top": [
    "–ë–ª–∏–∑–∫–æ –∫ –º–µ—Ç—Ä–æ (7 –º–∏–Ω)",
    "–°–≤–µ—Ç–ª–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å —Ö–æ—Ä–æ—à–∏–º –æ—Å–≤–µ—â–µ–Ω–∏–µ–º",
    "–¢–∏—Ö–∏–π –¥–≤–æ—Ä",
    "–†—è–¥–æ–º –ø–∞—Ä–∫ –¥–ª—è –ø—Ä–æ–≥—É–ª–æ–∫"
  ],
  "compromise": [
    "–ü–µ—Ä–≤—ã–π —ç—Ç–∞–∂",
    "–°–æ–≤–º–µ—â–µ–Ω–Ω—ã–π —Å–∞–Ω—É–∑–µ–ª"
  ],
  "price_context": "–¶–µ–Ω–∞ –Ω–∏–∂–µ —Ä—ã–Ω–∫–∞ –Ω–∞ 8%. –•–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ç–æ—Ä–≥–∞.",
  "routes": {
    "–î–æ —Ä–∞–±–æ—Ç—ã": {"auto": 35, "pt": 42}
  },
  "check_on_viewing": [
    "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —à—É–º–æ–∏–∑–æ–ª—è—Ü–∏—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–∫–æ–Ω"
  ]
}
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
app/
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ property.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îî‚îÄ‚îÄ property.py          # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ property_service.py  # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ property_scoring.py  # –°–∫–æ—Ä–∏–Ω–≥ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ property_handler.py  # Telegram –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îî‚îÄ‚îÄ property.py          # API endpoints
‚îî‚îÄ‚îÄ main.py                  # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
```

## API Endpoints

### –ö–ª–∏–µ–Ω—Ç—ã

- `POST /api/property/clients` - —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∫–ª–∏–µ–Ω—Ç–∞
- `GET /api/property/clients/telegram/{telegram_user_id}` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ Telegram ID
- `GET /api/property/clients/{client_id}` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ ID
- `PATCH /api/property/clients/{client_id}` - –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

### –õ–∏—Å—Ç–∏–Ω–≥–∏

- `POST /api/property/listings` - —Å–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
- `GET /api/property/listings/{listing_id}` - –ø–æ–ª—É—á–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
- `GET /api/property/listings?...filters` - –ø–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

### –ü–æ–¥–±–æ—Ä–∫–∏

- `POST /api/property/selections` - —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–±–æ—Ä–∫—É
- `POST /api/property/selections/{id}/items` - –¥–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç
- `GET /api/property/selections/{id}` - –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–±–æ—Ä–∫—É
- `GET /api/property/selections/token/{token}` - –ø—É–±–ª–∏—á–Ω–∞—è —Å—Å—ã–ª–∫–∞

### –§–∏–¥–±–µ–∫

- `POST /api/property/feedback` - –¥–æ–±–∞–≤–∏—Ç—å –ª–∞–π–∫/–¥–∏–∑–ª–∞–π–∫/–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- `GET /api/property/selections/{id}/feedback` - –ø–æ–ª—É—á–∏—Ç—å —Ñ–∏–¥–±–µ–∫

### –°–∫–æ—Ä–∏–Ω–≥

- `POST /api/property/score` - —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å Dream Score –¥–ª—è –æ–±—ä–µ–∫—Ç–∞
- `POST /api/property/rank` - —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Telegram –±–æ—Ç–∞

### –í `telegram_handler.py`

–î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç:
```python
from app.services.property_handler import property_handler
from app.services.property_service import property_service
from app.models.property import BotMode
```

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ –≤ `handle_update()`:
```python
# Check if user wants to switch to property mode
if message.text in ["üè† –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏", "–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏"]:
    await property_handler.handle_mode_switch(update, user_id, BotMode.PROPERTY)
    return

# Check current bot mode
current_mode = await property_service.get_user_mode(user_id)

if current_mode == BotMode.PROPERTY:
    # Handle in property mode
    await property_handler.handle_property_message(update, user_id, message.text)
    return
else:
    # Handle in calendar mode (default)
    await self._handle_text(update, user_id, message.text)
    return
```

–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback queries:
```python
# Handle property mode callbacks
if data.startswith("property_"):
    current_mode = await property_service.get_user_mode(user_id)
    if current_mode == BotMode.PROPERTY:
        await property_handler.handle_property_callback(update, user_id, data)
        return
```

## –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º—ã
‚úÖ –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ Dream Score (9 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤)
‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ –≤ Telegram
‚úÖ –£–ø—Ä–∞–≤–ª—è–µ–º—ã–π –ø–æ–∏—Å–∫ (step-by-step)
‚úÖ API endpoints
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–∞–π–∫–æ–≤/–¥–∏–∑–ª–∞–π–∫–æ–≤
‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–±–æ—Ä–æ–∫ —Å share-—Å—Å—ã–ª–∫–∞–º–∏

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)

üî¥ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∏–¥–∞–º–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏**
- –ü–∞—Ä—Å–∏–Ω–≥ Avito, –¶–∏–∞–Ω, –î–æ–º–∫–ª–∏–∫
- –ì–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ (Yandex Maps API)
- –†–∞—Å—á–µ—Ç –º–∞—Ç—Ä–∏—Ü—ã –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏

üî¥ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex AI**
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ free-form –∑–∞–ø—Ä–æ—Å–æ–≤
- –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ (—Å–≤–µ—Ç–ª–æ—Å—Ç—å, –≤–∏–¥, —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π

üî¥ **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
- POI-–ø–æ–∏—Å–∫ (Yandex Maps)
- –¶–µ–Ω–æ–≤–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–º–µ–¥–∏–∞–Ω–∞ –ø–æ —Ä–∞–π–æ–Ω—É)
- –î–∞–Ω–Ω—ã–µ –æ –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–∞—Ö

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)

üü° **UI/UX —É–ª—É—á—à–µ–Ω–∏—è**
- –ö–∞—Ä—Ç–æ—á–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ —Å —Ñ–æ—Ç–æ –≤ Telegram
- Inline-–∫–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –§–∏–ª—å—Ç—Ä—ã –≤ real-time

üü° **Share-—Å—Å—ã–ª–∫–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤**
- HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–¥–±–æ—Ä–∫–æ–π
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏
- –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

üü° **–û–Ω–ª–∞–π–Ω-–æ–±—É—á–µ–Ω–∏–µ**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –ø–æ —Ñ–∏–¥–±—ç–∫—É
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

üü¢ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**
- –î–∞—à–±–æ—Ä–¥ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π
- A/B —Ç–µ—Å—Ç—ã —Å–∫–æ—Ä–∏–Ω–≥–∞

üü¢ **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ñ–∏—á–∏**
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ API

```bash
curl -X POST "http://localhost:8000/api/property/clients" \
  -H "Content-Type: application/json" \
  -d '{
    "telegram_user_id": "123456789",
    "budget_min": 8000000,
    "budget_max": 12000000,
    "rooms_min": 2,
    "rooms_max": 3,
    "deal_type": "buy",
    "districts": ["–ë—É—Ç–æ–≤–æ"],
    "not_first_floor": true,
    "requires_elevator": true
  }'
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–∏–Ω–≥–∞

```bash
curl -X POST "http://localhost:8000/api/property/listings" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è –≤ –ñ–ö –°–æ–ª–Ω–µ—á–Ω—ã–π",
    "price": 9500000,
    "deal_type": "buy",
    "address_raw": "–ú–æ—Å–∫–≤–∞, –°–µ–≤–µ—Ä–Ω–æ–µ –ë—É—Ç–æ–≤–æ, —É–ª. –ö–æ–∫—Ç–µ–±–µ–ª—å—Å–∫–∞—è, 2",
    "lat": 55.533333,
    "lon": 37.533333,
    "district": "–ë—É—Ç–æ–≤–æ",
    "metro_station": "–ë—É–ª—å–≤–∞—Ä –î–º–∏—Ç—Ä–∏—è –î–æ–Ω—Å–∫–æ–≥–æ",
    "metro_distance_minutes": 7,
    "floor": 5,
    "floors_total": 17,
    "area_total": 65.5,
    "rooms": 2,
    "amenities": {"elevator": true, "balcony": true}
  }'
```

### 3. –ü–æ–∏—Å–∫ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü–æ–∏—Å–∫
curl "http://localhost:8000/api/property/listings?deal_type=buy&price_min=8000000&price_max=12000000&rooms_min=2&rooms_max=3"

# –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ
curl -X POST "http://localhost:8000/api/property/rank" \
  -H "Content-Type: application/json" \
  -d '{
    "client_id": "client-uuid",
    "listing_ids": ["listing-1", "listing-2", "listing-3"],
    "top_n": 10
  }'
```

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `requirements.txt` –µ—Å—Ç—å:
```
sqlalchemy>=2.0.0
pydantic>=2.0.0
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ. –¢–∞–±–ª–∏—Ü—ã:
- `property_clients`
- `property_listings`
- `property_selections`
- `selection_items`
- `selection_feedback`
- `user_bot_modes`

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
```bash
# Property Bot
YANDEX_MAPS_API_KEY=your_key_here  # –î–ª—è –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ó–∞–ø—É—Å–∫

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
python -m app.main

# Docker
docker-compose up --build
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞
2. –ù–∞–∂–º–∏—Ç–µ "üè† –ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç—Ä–æ–π–∫–∏"
3. –ù–∞–∂–º–∏—Ç–µ "üîç –ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫"
4. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –±–æ—Ç–∞

### –ß–µ—Ä–µ–∑ API

```bash
# –°—Ç–∞—Ç—É—Å
curl http://localhost:8000/api/property/status

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
open http://localhost:8000/docs
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –±–æ—Ç–∞ –ø–æ–∏—Å–∫–∞ –Ω–æ–≤–æ—Å—Ç—Ä–æ–µ–∫:

- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∏ –ø–æ–∏—Å–∫–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª—è–µ–º—ã–π –∏ —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ–∏—Å–∫
- ‚úÖ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ (Dream Score)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π "–ø–æ—á–µ–º—É —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç"
- ‚úÖ REST API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ñ–∏–¥–∞–º–∏ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ –∏ Yandex AI –¥–ª—è –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
