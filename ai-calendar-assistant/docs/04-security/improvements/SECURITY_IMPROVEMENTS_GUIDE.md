# üîí –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è AI Calendar Assistant.

**–î–∞—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** 28 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 2.0 (Security Hardened)

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. üîê –ó–∞—â–∏—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ [admin.py](app/routers/admin.py)

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–∞—Ä–æ–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –•—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` (–∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–§–∞–π–ª—ã:**
- [app/routers/admin.py](app/routers/admin.py) - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–∑ env
- [.env](.env) - –¥–æ–±–∞–≤–ª–µ–Ω—ã `ADMIN_PASSWORD_1`, `ADMIN_PASSWORD_2`, `ADMIN_PASSWORD_3`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –í .env:
ADMIN_PASSWORD_1=–≤–∞—à_–æ—Å–Ω–æ–≤–Ω–æ–π_–ø–∞—Ä–æ–ª—å
ADMIN_PASSWORD_2=–≤–∞—à_–≤—Ç–æ—Ä–∏—á–Ω—ã–π_–ø–∞—Ä–æ–ª—å
ADMIN_PASSWORD_3=–≤–∞—à_—Ç—Ä–µ—Ç–∏—á–Ω—ã–π_–ø–∞—Ä–æ–ª—å
```

---

### 2. üåê –ó–∞–∫—Ä—ã—Ç –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Radicale

**–ü—Ä–æ–±–ª–µ–º–∞:** Radicale CalDAV —Å–µ—Ä–≤–µ—Ä –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É 5232

**–†–µ—à–µ–Ω–∏–µ:**
- Radicale –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏
- –í–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç
- –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –∏ DDoS

**–§–∞–π–ª—ã:**
- [docker-compose.yml](docker-compose.yml) - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏

**–î–æ:**
```yaml
radicale:
  ports:
    - "5232:5232"  # ‚ùå –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

**–ü–æ—Å–ª–µ:**
```yaml
radicale:
  expose:
    - "5232"  # ‚úÖ –¢–æ–ª—å–∫–æ internal
  networks:
    - internal
```

---

### 3. üíæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Å–∏—Å—Ç–µ–º–∞ backup - —Ä–∏—Å–∫ –ø–æ–ª–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã (3:00 AM)
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å GPG
- –•—Ä–∞–Ω–µ–Ω–∏–µ 30 –¥–Ω–µ–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –æ–±–ª–∞–∫–æ

**–§–∞–π–ª—ã:**
- [backup-calendar.sh](backup-calendar.sh) - —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –±—ç–∫–∞–ø–∞
- [restore-from-backup.sh](restore-from-backup.sh) - —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–ß—Ç–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç—Å—è:**
- Radicale data (–≤—Å–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è)
- Bot data (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env, docker-compose.yml)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –±—ç–∫–∞–ø–∞
./backup-calendar.sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –±—ç–∫–∞–ø–æ–≤
ls -lh /root/backups/calendar-assistant/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
./restore-from-backup.sh /root/backups/calendar-assistant/20251028_030000.tar.gz.gpg
```

**Cron job:**
```bash
# –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
0 3 * * * /root/ai-calendar-assistant/backup-calendar.sh
```

---

### 4. üîí –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–æ–±–ª–µ–º–∞:** JSON —Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å `EncryptedStorage`
- Fernet (symmetric encryption)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
- –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª—ã:**
- [app/services/encrypted_storage.py](app/services/encrypted_storage.py)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
from app.services.encrypted_storage import encrypted_storage

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
data = {"user_id": "12345", "preferences": {...}}
encrypted_storage.save(data, "user_prefs.json", encrypt=True)

# –ó–∞–≥—Ä—É–∑–∏—Ç—å (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞)
data = encrypted_storage.load("user_prefs.json")

# –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–∞ (–ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏)
encrypted_storage.rotate_key()
```

**–ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤:**
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
# –ù–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –ø–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º
data = encrypted_storage.load("old_file.json")
# -> old_file.json.enc —Å–æ–∑–¥–∞–Ω, old_file.json —É–¥–∞–ª–µ–Ω
```

---

### 5. üìù –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª–∏—Å—å –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
- –°–∂–∞—Ç–∏–µ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
- –•—Ä–∞–Ω–µ–Ω–∏–µ 30 –¥–Ω–µ–π –¥–ª—è app logs, 14 –¥–ª—è nginx
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

**–§–∞–π–ª—ã:**
- [logrotate-calendar.conf](logrotate-calendar.conf)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo cp logrotate-calendar.conf /etc/logrotate.d/calendar-assistant

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
sudo logrotate -d /etc/logrotate.d/calendar-assistant

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è
sudo logrotate -f /etc/logrotate.d/calendar-assistant
```

---

### 6. üîë –£–Ω–∏–∫–∞–ª—å–Ω—ã–π SECRET_KEY

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π SECRET_KEY –∏–∑ –∫–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –∫–ª—é—á
- 32 –±–∞–π—Ç–∞ (256 –±–∏—Ç)
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ .env

**–î–æ:**
```python
SECRET_KEY=default-secret-key-change-in-production
```

**–ü–æ—Å–ª–µ:**
```python
SECRET_KEY=EtSGpUpspFDzH_Qf71FS47smg31X9oZ7VW7kkeR83AU
```

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π:

```bash
./deploy-security-improvements.sh
```

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç:
1. ‚úÖ Backup —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
2. ‚úÖ –ó–∞–≥—Ä—É–∑–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
4. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É logrotate
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É cron –¥–ª—è –±—ç–∫–∞–ø–æ–≤
6. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
8. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –±—ç–∫–∞–ø–∞

### –†—É—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Ä—É—á–Ω—É—é:

```bash
# 1. Backup —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
ssh root@server 'cd /root/ai-calendar-assistant && docker-compose down'
ssh root@server 'tar czf /root/backup-$(date +%Y%m%d).tar.gz /root/ai-calendar-assistant'

# 2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
scp app/routers/admin.py root@server:/root/ai-calendar-assistant/app/routers/
scp app/services/encrypted_storage.py root@server:/root/ai-calendar-assistant/app/services/
scp docker-compose.yml .env root@server:/root/ai-calendar-assistant/
scp backup-calendar.sh restore-from-backup.sh root@server:/root/ai-calendar-assistant/

# 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤
ssh root@server 'cd /root/ai-calendar-assistant && chmod +x *.sh'

# 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ logrotate
scp logrotate-calendar.conf root@server:/etc/logrotate.d/calendar-assistant

# 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron
ssh root@server '(crontab -l; echo "0 3 * * * /root/ai-calendar-assistant/backup-calendar.sh") | crontab -'

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
ssh root@server 'cd /root/ai-calendar-assistant && docker-compose up -d --build'

# 7. –ü–µ—Ä–≤—ã–π –±—ç–∫–∞–ø
ssh root@server '/root/ai-calendar-assistant/backup-calendar.sh'
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª–µ–π –∏–∑ env

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ –ø–∞—Ä–æ–ª–µ–π
docker-compose logs telegram-bot | grep -i "password"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "encrypted_storage_initialized" –∏ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è Radicale –ø–æ—Ä—Ç–∞

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã
netstat -tlnp | grep 5232

# –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–∫ —Å 0.0.0.0:5232

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–Ω–µ (–¥–æ–ª–∂–Ω–∞ FAIL–ò–¢–¨)
curl http://91.229.8.221:5232
# Connection refused - ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–Ω—É—Ç—Ä–∏ Docker (–¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å)
docker exec telegram-bot curl http://radicale:5232
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç - ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–∞

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä—É—á–Ω–æ–π –±—ç–∫–∞–ø
./backup-calendar.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
ls -lh /root/backups/calendar-assistant/

# –¢–µ—Å—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (–û–ü–ê–°–ù–û - –¥–µ–ª–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ staging!)
./restore-from-backup.sh /root/backups/calendar-assistant/latest.tar.gz.gpg
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ñ–∞–π–ª—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã
docker exec telegram-bot ls -la /var/lib/calendar-bot/

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .enc
# user_preferences.json.enc
# analytics_data.json.enc

# –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—á–∏—Ç–∞–µ–º–æ)
docker exec telegram-bot cat /var/lib/calendar-bot/user_preferences.json.enc
# –ë–∏–Ω–∞—Ä–Ω—ã–π –º—É—Å–æ—Ä - ‚úÖ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±—ç–∫–∞–ø–∞
tail -f /var/log/calendar-backup.log

# –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
ls -lh /root/backups/calendar-assistant/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±—ç–∫–∞–ø–æ–≤
du -sh /root/backups/calendar-assistant/
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤
ls -lh /var/log/calendar-assistant/

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã:
# app.log
# app.log.1.gz
# app.log.2.gz
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ cron jobs

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö cron jobs
crontab -l

# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
# 0 3 * * * /root/ai-calendar-assistant/backup-calendar.sh
```

---

## üÜò –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–µ

### 1. –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏
python3 -c "import secrets; print(secrets.token_urlsafe(16))"

# –û–±–Ω–æ–≤–∏—Ç—å .env
nano /root/ai-calendar-assistant/.env

# –û–±–Ω–æ–≤–∏—Ç—å ADMIN_PASSWORD_1, ADMIN_PASSWORD_2, ADMIN_PASSWORD_3

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose restart
```

### 2. –ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

```python
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it telegram-bot python3

# –†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–∞
from app.services.encrypted_storage import encrypted_storage
encrypted_storage.rotate_key()

# Backup —Å—Ç–∞—Ä–æ–≥–æ –∫–ª—é—á–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ .encryption_key.backup
```

### 3. –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞
./restore-from-backup.sh /root/backups/calendar-assistant/$(ls -t /root/backups/calendar-assistant/ | head -1)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
docker-compose ps
docker-compose logs -f
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç: https://—ç—Ç–æ–Ω–µ—Å–∞–º—ã–π–¥–ª–∏–Ω–Ω—ã–π–¥–æ–º–µ–Ω.—Ä—Ñ
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏
- [ ] –ë—ç–∫–∞–ø—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞)
- [ ] Radicale –ù–ï –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ –Ω–∞ –ø–æ—Ä—Ç—É 5232
- [ ] –õ–æ–≥–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é)
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –≤ Telegram
- [ ] –°–æ–±—ã—Ç–∏—è —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è

---

## üîê –†–µ–π—Ç–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π: 6/10 ‚ö†Ô∏è

- ‚ùå –ü–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ
- ‚ùå –ù–µ—Ç –±—ç–∫–∞–ø–æ–≤
- ‚ùå Radicale –ø—É–±–ª–∏—á–Ω—ã–π
- ‚ùå –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –¢—Ä–µ—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ PII masking

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π: 9/10 ‚úÖ

- ‚úÖ –ü–∞—Ä–æ–ª–∏ –≤ environment variables
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –±—ç–∫–∞–ø—ã
- ‚úÖ Radicale —Ç–æ–ª—å–∫–æ internal
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –¢—Ä–µ—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ PII masking
- ‚úÖ Log rotation
- ‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω—ã–π SECRET_KEY

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Fail2ban** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
```bash
apt install fail2ban
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è Nginx –∏ Docker
```

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - Prometheus + Grafana
```bash
# –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
# –ê–ª–µ—Ä—Ç—ã –Ω–∞ email/Telegram
```

3. **2FA –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - TOTP —á–µ—Ä–µ–∑ Telegram
```python
# –î–æ–±–∞–≤–∏—Ç—å pyotp
# QR –∫–æ–¥—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
```

4. **Rate limiting —Å Redis**
```python
# –£–∂–µ –µ—Å—Ç—å –≤ –∫–æ–¥–µ
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–º–∏—Ç—ã
```

5. **WAF** - ModSecurity –¥–ª—è Nginx
```bash
# –ó–∞—â–∏—Ç–∞ –æ—Ç OWASP Top 10
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OWASP Top 10](https://owasp.org/Top10/)
- [Docker Security Best Practices](https://docs.docker.com/engine/security/)
- [Cryptography Library Docs](https://cryptography.io/)
- [Radicale Documentation](https://radicale.org/v3.html)

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker-compose logs -f`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å backup logs: `tail -f /var/log/calendar-backup.log`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cron: `crontab -l`
4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 28 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 2.0
