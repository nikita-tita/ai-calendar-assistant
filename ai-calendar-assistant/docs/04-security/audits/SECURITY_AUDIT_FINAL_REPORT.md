# üîí –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∞—É–¥–∏—Ç—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 28 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 2.0 - –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ù–ê–ô–î–ï–ù–´

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ!)

### 1. ‚ö†Ô∏è Radicale –î–û–°–¢–£–ü–ï–ù –ü–£–ë–õ–ò–ß–ù–û

**–°—Ç–∞—Ç—É—Å:** üî¥ –ê–ö–¢–ò–í–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**CVSS Score:** 9.1 (Critical)

```bash
# –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
$ curl http://95.163.227.26:5232
HTTP/1.0 302 Found  # ‚ùå –î–û–°–¢–£–ü–ï–ù!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Ä—Ç 5232 –æ—Ç–∫—Ä—ã—Ç –¥–ª—è –≤—Å–µ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –î–æ—Å—Ç—É–ø –∫ CalDAV —Å–µ—Ä–≤–µ—Ä—É –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–í–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏:**
```bash
# –õ—é–±–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç:
curl http://95.163.227.26:5232/2296243/  # –î–æ—Å—Ç—É–ø –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π, –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```

**–†–µ—à–µ–Ω–∏–µ:** –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç –≤ docker-compose.yml

---

### 2. ‚ö†Ô∏è .env –§–ê–ô–õ READABLE BY ALL

**–°—Ç–∞—Ç—É—Å:** üî¥ –ê–ö–¢–ò–í–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**CVSS Score:** 8.8 (High)

```bash
# –¢–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∞:
-rw-r--r-- /root/ai-calendar-assistant/.env  # ‚ùå –û–ü–ê–°–ù–û!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –§–∞–π–ª .env —Å–æ–¥–µ—Ä–∂–∏—Ç –í–°–ï —Å–µ–∫—Ä–µ—Ç—ã (API keys, –ø–∞—Ä–æ–ª–∏, tokens)
- Readable by group –∏ others
- –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ .env:**
- TELEGRAM_BOT_TOKEN
- YANDEX_GPT_API_KEY
- ADMIN_PASSWORD_1, ADMIN_PASSWORD_2, ADMIN_PASSWORD_3
- SECRET_KEY
- RADICALE_BOT_PASSWORD
- REDIS_PASSWORD
- TELEGRAM_WEBHOOK_SECRET

**–†–µ—à–µ–Ω–∏–µ:** `chmod 600 .env`

---

### 3. ‚ö†Ô∏è –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô –ù–ï –ó–ê–®–ò–§–†–û–í–ê–ù–´

**–°—Ç–∞—Ç—É—Å:** üî¥ –ê–ö–¢–ò–í–ù–ê–Ø –£–Ø–ó–í–ò–ú–û–°–¢–¨
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π
**CVSS Score:** 7.5 (High)

```json
// /var/lib/calendar-bot/user_preferences.json
{
  "2296243": {
    "motivation_index": 9,
    "language": "ru",
    "timezone": "Europe/Moscow"  // ‚ùå PLAINTEXT
  }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- user_preferences.json –≤ plaintext
- analytics_data.json –≤ plaintext
- –î–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º –¥–æ—Å—Ç—É–ø–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
- –î–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ —É—Ç–µ—á–∫–µ backup'–∞

**–î–∞–Ω–Ω—ã–µ –ø–æ–¥ —Ä–∏—Å–∫–æ–º:**
- User IDs (Telegram)
- –Ø–∑—ã–∫–∏ –∏ —Ç–∞–π–º–∑–æ–Ω—ã (–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è)
- –ò–Ω–¥–µ–∫—Å—ã –º–æ—Ç–∏–≤–∞—Ü–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å encrypted_storage.py –¥–ª—è –≤—Å–µ—Ö JSON —Ñ–∞–π–ª–æ–≤

---

### 4. ‚ùå –û–¢–°–£–¢–°–¢–í–£–Æ–¢ –ë–≠–ö–ê–ü–´

**–°—Ç–∞—Ç—É—Å:** üî¥ –ö–†–ò–¢–ò–ß–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
**–†–∏—Å–∫:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö)
**Impact:** –ë–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–∞—è –ø–æ—Ç–µ—Ä—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ–µ

```bash
$ ls /root/backups/calendar-assistant/
ls: cannot access: No such file or directory
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞
- Cron job –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- –ü—Ä–∏ —Å–±–æ–µ —Å–µ—Ä–≤–µ—Ä–∞/–¥–∏—Å–∫–∞ - –ø–æ—Ç–µ—Ä—è –í–°–ï–• –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–î–∞–Ω–Ω—ã–µ –ø–æ–¥ —Ä–∏—Å–∫–æ–º:**
- –í—Å–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è
- –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

**RTO (Recovery Time Objective):** ‚àû (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)
**RPO (Recovery Point Objective):** ‚àû (–ø–æ—Ç–µ—Ä—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö)

---

## üü° –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### 5. ‚ö†Ô∏è OAuth –¢–û–ö–ï–ù–´ –ù–ï –ó–ê–©–ò–©–ï–ù–´ –î–û–õ–ñ–ù–´–ú –û–ë–†–ê–ó–û–ú

**–§–∞–π–ª:** `app/services/sync_database.py`

```python
# –¢–æ–∫–µ–Ω—ã —à–∏—Ñ—Ä—É—é—Ç—Å—è, –ù–û:
access_token TEXT NOT NULL,  # –í SQLite –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è DB
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ë–∞–∑–∞ SQLite –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∞
- –ü—Ä–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º –¥–æ—Å—Ç—É–ø–µ —Ç–æ–∫–µ–Ω—ã –º–æ–∂–Ω–æ –∏–∑–≤–ª–µ—á—å
- Fernet —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ DB plaintext

**–†–µ—à–µ–Ω–∏–µ:** SQLCipher –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π –±–∞–∑—ã

---

### 6. ‚ö†Ô∏è HARDCODED –ü–ê–†–û–õ–ò –í–°–ï –ï–©–ï –í GIT –ò–°–¢–û–†–ò–ò

```bash
$ git log --all --full-history -- app/routers/admin.py | grep -C 3 "PASSWORD"
# –ü–∞—Ä–æ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–º–º–∏—Ç–æ–≤!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°—Ç–∞—Ä—ã–µ –ø–∞—Ä–æ–ª–∏ –≤ git history
- –î–∞–∂–µ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∫–æ–¥–∞, history —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Ö
- –õ—é–±–æ–π —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ repo –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ø–∞—Ä–æ–ª–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–∞—Ä–æ–ª–∏
2. git filter-branch –∏–ª–∏ BFG Repo-Cleaner
3. Force push

---

### 7. ‚ö†Ô∏è WEBHOOK –ù–ï –ü–†–û–í–ï–†–Ø–ï–¢ IP –ò–°–¢–û–ß–ù–ò–ö–ê

**–§–∞–π–ª:** `app/routers/telegram.py:48`

```python
if settings.telegram_webhook_secret:
    if x_telegram_bot_api_secret_token != settings.telegram_webhook_secret:
        raise HTTPException(status_code=401)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ secret token
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è IP –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- –í–æ–∑–º–æ–∂–Ω—ã replay attacks

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å whitelist Telegram IP ranges

---

## üü¢ –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### 8. ‚ö†Ô∏è RATE LIMITING –ù–ï –ê–ö–¢–ò–í–ï–ù

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Rate limiting —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –∫–æ–¥–µ
- –ù–æ Redis –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω/–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- DDoS –Ω–∞ API endpoints –≤–æ–∑–º–æ–∂–µ–Ω

### 9. ‚ö†Ô∏è –õ–û–ì–ò –°–û–î–ï–†–ñ–ê–¢ SENSITIVE DATA

```python
logger.info("admin_login_success", mode=auth_type)  # OK
logger.info("webhook_received", user_id=update.effective_user.id)  # PII
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- User IDs –≤ –ª–æ–≥–∞—Ö (PII)
- –•–æ—Ç—è –µ—Å—Ç—å pii_masking.py, –Ω–µ –≤–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### 10. ‚ö†Ô∏è ADMIN TOKEN –ù–ï –ò–ú–ï–ï–¢ EXPIRY

**–§–∞–π–ª:** `app/routers/admin.py:131`

```python
token = hashlib.sha256(combined.encode()).hexdigest()
return {"valid": True, "mode": auth_type, "token": token}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –¢–æ–∫–µ–Ω –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç
- –ü—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –≤–µ—á–Ω–æ
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç–∑—ã–≤–∞

---

## üìä –¢–ï–°–¢-–ö–ï–ô–°–´

### Test Case 1: Penetration Test - Radicale Access

```bash
# –¢–µ—Å—Ç 1: –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ Radicale
curl http://95.163.227.26:5232/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Connection refused
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå HTTP 302 (–¥–æ—Å—Ç—É–ø–µ–Ω)

# –¢–µ—Å—Ç 2: –î–æ—Å—Ç—É–ø –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl http://95.163.227.26:5232/2296243/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Connection refused
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå HTTP 401 Unauthorized (–Ω–æ –î–û–°–¢–£–ü–ï–ù!)

# –¢–µ—Å—Ç 3: –ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
for i in {1..1000}; do
  curl -u "user:pass$i" http://95.163.227.26:5232/ &
done
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Rate limiting, ban IP
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå FAILED - Radicale –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω

---

### Test Case 2: Data Encryption at Rest

```bash
# –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è user preferences
docker exec telegram-bot cat /var/lib/calendar-bot/user_preferences.json
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ)
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå JSON plaintext

# –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ SQLite
docker exec telegram-bot sqlite3 /var/lib/calendar-bot/sync.db "SELECT * FROM calendar_connections"
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Encrypted tokens
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ö†Ô∏è –¢–æ–∫–µ–Ω—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã Fernet, –Ω–æ DB plaintext

# –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ .env permissions
ls -la /root/ai-calendar-assistant/.env
# –û–∂–∏–¥–∞–µ—Ç—Å—è: -rw------- (600)
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå -rw-r--r-- (644)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå FAILED - –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º

---

### Test Case 3: Backup and Disaster Recovery

```bash
# –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –±—ç–∫–∞–ø–æ–≤
ls /root/backups/calendar-assistant/
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ backup
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå No such file or directory

# –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ cron job
crontab -l | grep backup
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 0 3 * * * /root/ai-calendar-assistant/backup-calendar.sh
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå –ü—É—Å—Ç–æ

# –¢–µ—Å—Ç 3: –°–∏–º—É–ª—è—Ü–∏—è –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
docker volume rm calendar-assistant_radicale_data
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ - –Ω–µ—Ç –±—ç–∫–∞–ø–æ–≤
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ùå FAILED - –ù–µ—Ç disaster recovery

---

### Test Case 4: Authentication Security

```bash
# –¢–µ—Å—Ç 1: –ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
for i in {1..1000}; do
  curl -X POST http://95.163.227.26:8000/api/admin/verify \
    -H "Content-Type: application/json" \
    -d '{"password1":"test","password2":"test","password3":"test"}' &
done
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Rate limiting, IP ban –ø–æ—Å–ª–µ 10 –ø–æ–ø—ã—Ç–æ–∫
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ö†Ô∏è –ù–µ—Ç rate limiting

# –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ SQL injection
curl http://95.163.227.26:8000/api/events/2296243' OR '1'='1
# –û–∂–∏–¥–∞–µ—Ç—Å—è: 400 Bad Request
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)

# –¢–µ—Å—Ç 3: XSS –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Å–æ–±—ã—Ç–∏–π
curl -X POST http://95.163.227.26:8000/api/events/2296243 \
  -d '{"title":"<script>alert(1)</script>"}'
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ö†Ô∏è PARTIAL - SQL injection –∑–∞—â–∏—â–µ–Ω, –Ω–æ –Ω–µ—Ç rate limiting

---

### Test Case 5: Server Resilience

```bash
# –¢–µ—Å—Ç 1: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
sudo reboot
# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:
docker ps
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã UP (restart: unless-stopped)
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

# –¢–µ—Å—Ç 2: –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker rm -f telegram-bot
docker-compose up -d
# –û–∂–∏–¥–∞–µ—Ç—Å—è: –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ volumes
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

# –¢–µ—Å—Ç 3: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–∞
dd if=/dev/zero of=/tmp/fill bs=1M count=10000
# –û–∂–∏–¥–∞–µ—Ç—Å—è: Graceful degradation, alerts
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏: ‚ùå –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚ö†Ô∏è PARTIAL - Restart —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üéØ –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### üî¥ P0 - –ö–†–ò–¢–ò–ß–ù–û (–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è)

1. **–ó–∞–∫—Ä—ã—Ç—å Radicale –ø—É–±–ª–∏—á–Ω—ã–π –ø–æ—Ä—Ç** (5 –º–∏–Ω—É—Ç)
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ .env** ‚Üí `chmod 600` (1 –º–∏–Ω—É—Ç–∞)
3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–π backup** (10 –º–∏–Ω—É—Ç)

### üü† P1 - –í–´–°–û–ö–ò–ô (–ò—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç—É –Ω–µ–¥–µ–ª—é)

4. **–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å JSON —Ñ–∞–π–ª—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å encrypted_storage.py
5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å cron –¥–ª—è backup** - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã
6. **–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å SQLite –±–∞–∑—É** - SQLCipher
7. **–°–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø–∞—Ä–æ–ª–∏** - —É–¥–∞–ª–∏—Ç—å –∏–∑ git history

### üü° P2 - –°–†–ï–î–ù–ò–ô (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞)

8. **–î–æ–±–∞–≤–∏—Ç—å rate limiting** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Redis
9. **Token expiry –¥–ª—è –∞–¥–º–∏–Ω–∞** - JWT —Å expiry
10. **IP whitelist –¥–ª—è webhook** - Telegram IP ranges
11. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞** - alerts –Ω–∞ 80% –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üìù –ì–û–¢–û–í–´–ô –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –®–∞–≥ 1: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (30 –º–∏–Ω—É—Ç)

```bash
# 1. –ó–∞–∫—Ä—ã—Ç—å Radicale –ø–æ—Ä—Ç
ssh root@server
cd /root/ai-calendar-assistant
nano docker-compose.yml
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å ports: - "5232:5232"
docker-compose up -d

# 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ .env
chmod 600 .env

# 3. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π backup –≤—Ä—É—á–Ω—É—é
./backup-calendar.sh  # –ù–æ —Å–∫—Ä–∏–ø—Ç –µ—â–µ –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!
```

### –®–∞–≥ 2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π (1 —á–∞—Å)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å deployment script
./deploy-security-improvements.sh
```

### –®–∞–≥ 3: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (30 –º–∏–Ω—É—Ç)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∏–∑ Test Cases –≤—ã—à–µ
```

---

## üìà –ú–ï–¢–†–ò–ö–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ —É–ª—É—á—à–µ–Ω–∏–π | –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π | –¶–µ–ª—å |
|---------|-------------|-----------------|------|
| **Radicale –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø** | ‚ùå –î–∞ | ‚úÖ –ù–µ—Ç | ‚úÖ –ù–µ—Ç |
| **–î–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã** | ‚ùå –ù–µ—Ç | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | ‚úÖ –î–∞ |
| **–ë—ç–∫–∞–ø—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| **–ü–∞—Ä–æ–ª–∏ –≤ –∫–æ–¥–µ** | ‚ùå –î–∞ | ‚úÖ –ù–µ—Ç | ‚úÖ –ù–µ—Ç |
| **.env permissions** | ‚ùå 644 | ‚úÖ 600 | ‚úÖ 600 |
| **CVSS Score (—Å—Ä–µ–¥–Ω–∏–π)** | 8.5 (High) | 4.2 (Medium) | <3.0 |

---

## üîí –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –¢–µ–∫—É—â–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: 4/10 ‚ö†Ô∏è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå Radicale –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ
- ‚ùå .env readable by all
- ‚ùå –ù–µ—Ç –±—ç–∫–∞–ø–æ–≤
- ‚ùå –î–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π: 9/10 ‚úÖ

**–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —É–ª—É—á—à–µ–Ω–∏–π:**
- ‚úÖ Radicale –∑–∞—â–∏—â–µ–Ω
- ‚úÖ –ë—ç–∫–∞–ø—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –≤ env
- ‚úÖ –ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ

---

## ‚ö° –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ–π—á–∞—Å:**

```bash
# 1. –ó–∞–∫—Ä—ã—Ç—å Radicale (–ö–†–ò–¢–ò–ß–ù–û!)
ssh root@95.163.227.26 "cd /root/ai-calendar-assistant && \
  sed -i 's/- \"5232:5232\"/# - \"5232:5232\"/g' docker-compose.yml && \
  docker-compose up -d"

# 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å .env permissions (–ö–†–ò–¢–ò–ß–ù–û!)
ssh root@95.163.227.26 "chmod 600 /root/ai-calendar-assistant/.env"

# 3. –ó–∞—Ç–µ–º —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ —É–ª—É—á—à–µ–Ω–∏—è
./deploy-security-improvements.sh
```

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞—É–¥–∏—Ç–∞:** 28 –æ–∫—Ç—è–±—Ä—è 2025, 03:00
**–°–ª–µ–¥—É—é—â–∏–π –∞—É–¥–∏—Ç:** –ß–µ—Ä–µ–∑ 1 –º–µ—Å—è—Ü –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
